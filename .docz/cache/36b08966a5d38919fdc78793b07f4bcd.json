{"remainingRequest":"F:\\slate\\easteduCompoents\\node_modules\\thread-loader\\dist\\cjs.js??ref--11-1!F:\\slate\\easteduCompoents\\node_modules\\docz-core\\node_modules\\babel-loader\\lib\\index.js??ref--11-2!F:\\slate\\easteduCompoents\\node_modules\\source-map-loader\\index.js!F:\\slate\\easteduCompoents\\src\\QuestionEditor\\editor\\index.tsx","dependencies":[{"path":"F:\\slate\\easteduCompoents\\src\\QuestionEditor\\editor\\index.tsx","mtime":1611712276669},{"path":"F:\\slate\\easteduCompoents\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1611297672593},{"path":"F:\\slate\\easteduCompoents\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1611297676370},{"path":"F:\\slate\\easteduCompoents\\node_modules\\docz-core\\node_modules\\babel-loader\\lib\\index.js","mtime":1611297672218},{"path":"F:\\slate\\easteduCompoents\\node_modules\\source-map-loader\\index.js","mtime":1599723087186}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRjpcXHNsYXRlXFxlYXN0ZWR1Q29tcG9lbnRzXFxub2RlX21vZHVsZXNcXGJhYmVsLXByZXNldC1yZWFjdC1hcHBcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkY6XFxzbGF0ZVxcZWFzdGVkdUNvbXBvZW50c1xcbm9kZV9tb2R1bGVzXFxiYWJlbC1wcmVzZXQtcmVhY3QtYXBwXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRjpcXHNsYXRlXFxlYXN0ZWR1Q29tcG9lbnRzXFxub2RlX21vZHVsZXNcXGJhYmVsLXByZXNldC1yZWFjdC1hcHBcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJGOlxcc2xhdGVcXGVhc3RlZHVDb21wb2VudHNcXG5vZGVfbW9kdWxlc1xcYmFiZWwtcHJlc2V0LXJlYWN0LWFwcFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIkY6XFxzbGF0ZVxcZWFzdGVkdUNvbXBvZW50c1xcbm9kZV9tb2R1bGVzXFxiYWJlbC1wcmVzZXQtcmVhY3QtYXBwXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAiYW50ZC9lcy90YWJzL3N0eWxlIjsKaW1wb3J0IF9UYWJzIGZyb20gImFudGQvZXMvdGFicyI7CnZhciBfanN4RmlsZU5hbWUgPSAiRjpcXHNsYXRlXFxlYXN0ZWR1Q29tcG9lbnRzXFxzcmNcXFF1ZXN0aW9uRWRpdG9yXFxlZGl0b3JcXGluZGV4LnRzeCI7CgooZnVuY3Rpb24gKCkgewogIHZhciBlbnRlck1vZHVsZSA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbC5lbnRlck1vZHVsZSA6IHVuZGVmaW5lZDsKICBlbnRlck1vZHVsZSAmJiBlbnRlck1vZHVsZShtb2R1bGUpOwp9KSgpOwoKdmFyIF9fc2lnbmF0dXJlX18gPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWxbImRlZmF1bHQiXS5zaWduYXR1cmUgOiBmdW5jdGlvbiAoYSkgewogIHJldHVybiBhOwp9OwoKaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IFJpY2hUZXh0IGZyb20gJy4vcmljaHRleHQnOwppbXBvcnQgQ2hvaWNlQW5zd2VyIGZyb20gJy4vY2hvaWNlQW5zd2VyJzsKaW1wb3J0IEp1ZGdlbWVudEFuc3dlciBmcm9tICcuL2NvbXBvbmVudHMvSnVkZ2VtZW50QW5zd2VyJzsgLy8gaW1wb3J0IHsgVGlwcyB9IGZyb20gJy4uL2luZGV4JzsKCmltcG9ydCB7IFRpcHMgfSBmcm9tICcuLi8uLi9NZXNzYWdlVGlwcyc7CmltcG9ydCB7IHNob3dNYXRoSmF4LCBnZXRRdWVzdGlvbkh0bWwsIGdldEVtcHR5T3B0aW9uLCBxdWVzdGlvblR5cGVUZXh0LCBvcHRpb25WYWx1ZSwgZ2V0VmlkZW9VcmwgfSBmcm9tICcuL2NsaWVudCc7CmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2gvZGVib3VuY2UnOwppbXBvcnQgJy4vcmljaHRleHQubGVzcyc7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CnZhciBUYWJQYW5lID0gX1RhYnMuVGFiUGFuZTsgLy8gaW1wb3J0IExvYWRNYXRoIGZyb20gJy4vbG9hZE1hdGgvaW5kZXgnOwoKaWYgKHR5cGVvZiBFZGl0SXRlbVByb3BzICE9PSAndW5kZWZpbmVkJyAmJiBFZGl0SXRlbVByb3BzICYmIEVkaXRJdGVtUHJvcHMgPT09IE9iamVjdChFZGl0SXRlbVByb3BzKSAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKEVkaXRJdGVtUHJvcHMpKSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVkaXRJdGVtUHJvcHMsICdfX2ZpbGVtZXRhJywgewogICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIHZhbHVlOiB7CiAgICAgIG5hbWU6ICJFZGl0SXRlbVByb3BzIiwKICAgICAgZmlsZW5hbWU6ICJzcmNcXFF1ZXN0aW9uRWRpdG9yXFxlZGl0b3JcXGluZGV4LnRzeCIKICAgIH0KICB9KTsKfQoKdmFyIEVkaXRJdGVtID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKEVkaXRJdGVtLCBfQ29tcG9uZW50KTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihFZGl0SXRlbSk7CgogIF9jcmVhdGVDbGFzcyhFZGl0SXRlbSwgbnVsbCwgW3sKICAgIGtleTogImdldERlcml2ZWRTdGF0ZUZyb21FcnJvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yKCkgewogICAgICAvLyBVcGRhdGUgc3RhdGUgc28gdGhlIG5leHQgcmVuZGVyIHdpbGwgc2hvdyB0aGUgZmFsbGJhY2sgVUkuCiAgICAgIHJldHVybiB7CiAgICAgICAgaGFzRXJyb3I6IHRydWUKICAgICAgfTsKICAgIH0KICB9XSk7CgogIGZ1bmN0aW9uIEVkaXRJdGVtKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVkaXRJdGVtKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTsgLy8gbGV0IGluaXRWYWwgPSBjaGFuZ2VKc29uKHByb3BzLnZhbHVlLnF1ZXN0aW9uLnN0ZW0pOwoKICAgIF90aGlzLmNoYW5nQ2hpbGQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJzIyMicpOwogICAgfTsKCiAgICBfdGhpcy5jaGFuZ2VWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXhBcnIsIGVpLCBxdWVzdGlvblR5cGUpIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICBfdGhpcy5wcm9wcy5jaGFuZ2VWYWx1ZSAmJiBfdGhpcy5wcm9wcy5jaGFuZ2VWYWx1ZSh2YWx1ZSwgaW5kZXhBcnIsIGVpLCBxdWVzdGlvblR5cGUpOwogICAgfTsKCiAgICBfdGhpcy5oYW5kbGVCYXRjaE9rID0gZnVuY3Rpb24gKG4pIHsKICAgICAgdmFyIF90aGlzJHN0YXRlID0gX3RoaXMuc3RhdGUsCiAgICAgICAgICBxdWVzdGlvbkl0ZW0gPSBfdGhpcyRzdGF0ZS5xdWVzdGlvbkl0ZW0sCiAgICAgICAgICBxdWVzdGlvblN0cnVjdHVyZSA9IF90aGlzJHN0YXRlLnF1ZXN0aW9uU3RydWN0dXJlLAogICAgICAgICAgaXNDaGFuZ2VRdWVzdGlvbkxpc3QgPSBfdGhpcyRzdGF0ZS5pc0NoYW5nZVF1ZXN0aW9uTGlzdCwKICAgICAgICAgIHR5cGUgPSBfdGhpcyRzdGF0ZS50eXBlLAogICAgICAgICAgdmlkZW9VcmwgPSBfdGhpcyRzdGF0ZS52aWRlb1VybDsKICAgICAgdmFyIGNoYW5nZVZhbHVlID0gZ2V0UXVlc3Rpb25IdG1sKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocXVlc3Rpb25TdHJ1Y3R1cmUpKSwgdHlwZSk7CgogICAgICBpZiAoY2hhbmdlVmFsdWUucXVlc3Rpb25MaXN0WydxdWVzdGlvbnMnXSkgewogICAgICAgIGNoYW5nZVZhbHVlLnF1ZXN0aW9uTGlzdFsncXVlc3Rpb25zJ10gPSBjaGFuZ2VWYWx1ZS5xdWVzdGlvbkxpc3RbJ3F1ZXN0aW9ucyddLm1hcChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHF1ZXN0aW9uSXRlbVsncXVlc3Rpb24nXVsncXVlc3Rpb25zJ11baW5kZXhdKSwgaXRlbSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHZhciBuZXdRdWVzdGlvbkl0ZW0gPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHF1ZXN0aW9uSXRlbSksIHt9LCB7CiAgICAgICAgcXVlc3Rpb246IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBxdWVzdGlvbkl0ZW1bJ3F1ZXN0aW9uJ10pLCBjaGFuZ2VWYWx1ZS5xdWVzdGlvbkxpc3QpLCB7fSwgewogICAgICAgICAgaXNDaGFuZ2VRdWVzdGlvbkxpc3Q6IG4gPT09IDEgPyBpc0NoYW5nZVF1ZXN0aW9uTGlzdCA6IFtdCiAgICAgICAgfSkKICAgICAgfSk7CgogICAgICBpZiAoY2hhbmdlVmFsdWUuZXJyTGlzdC5sZW5ndGggPiAwICYmIG4gIT09IDApIHsKICAgICAgICBUaXBzLm9wZW4oewogICAgICAgICAgbWVzc2FnZTogIlx1OEJGN1x1NUI4Q1x1NTU4NFx1NTE4NVx1NUJCOSIsCiAgICAgICAgICB0eXBlOiAnZmFpbCcKICAgICAgICB9KTsKICAgICAgICB2YXIgZXJyS2V5ID0gY2hhbmdlVmFsdWUuZXJyTGlzdC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmluZGV4OwogICAgICAgIH0pOwogICAgICAgIGVycktleSA9IGVycktleS5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlICE9PSB1bmRlZmluZWQ7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgIHF1ZXN0aW9uU3RydWN0dXJlOiBjaGFuZ2VWYWx1ZS5xdWVzdGlvbiwKICAgICAgICAgIGVyckxpc3Q6IGVycktleSwKICAgICAgICAgIGFjdGl2ZUtleTogIiIuY29uY2F0KGVycktleSAmJiBlcnJLZXkubGVuZ3RoID4gMCA/IGVycktleVswXSA6IF90aGlzLnN0YXRlLmFjdGl2ZUtleSkKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodmlkZW9VcmwuY29udGVudCkgewogICAgICAgICAgbmV3UXVlc3Rpb25JdGVtLnF1ZXN0aW9uLnN0ZW0ucHVzaCh7CiAgICAgICAgICAgIGFsaWdubWVudDogIkxlZnQiLAogICAgICAgICAgICBmcmFnbWVudHM6IFt7CiAgICAgICAgICAgICAgY29udGVudDogdmlkZW9VcmwuY29udGVudCwKICAgICAgICAgICAgICBtZWRpYVR5cGU6ICJBVURJTyIsCiAgICAgICAgICAgICAgc3R5bGVzOiBbXQogICAgICAgICAgICB9XSwKICAgICAgICAgICAgaW5kZW50YXRpb246IDAsCiAgICAgICAgICAgIHN0eWxlczogW10KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgOwoKICAgICAgICBpZiAodmlkZW9VcmwucXVlc3Rpb25zICYmIE9iamVjdC5rZXlzKHZpZGVvVXJsLnF1ZXN0aW9ucykubGVuZ3RoID4gMCkgewogICAgICAgICAgZm9yICh2YXIga2V5IGluIHZpZGVvVXJsLnF1ZXN0aW9ucykgewogICAgICAgICAgICBpZiAodmlkZW9VcmwucXVlc3Rpb25zLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHZpZGVvVXJsLnF1ZXN0aW9uc1trZXldLmNvbnRlbnQ7CgogICAgICAgICAgICAgIGlmIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICBuZXdRdWVzdGlvbkl0ZW0ucXVlc3Rpb24ucXVlc3Rpb25zW2tleV0uc3RlbS5wdXNoKHsKICAgICAgICAgICAgICAgICAgYWxpZ25tZW50OiAiTGVmdCIsCiAgICAgICAgICAgICAgICAgIGZyYWdtZW50czogW3sKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBlbGVtZW50LAogICAgICAgICAgICAgICAgICAgIG1lZGlhVHlwZTogIkFVRElPIiwKICAgICAgICAgICAgICAgICAgICBzdHlsZXM6IFtdCiAgICAgICAgICAgICAgICAgIH1dLAogICAgICAgICAgICAgICAgICBpbmRlbnRhdGlvbjogMCwKICAgICAgICAgICAgICAgICAgc3R5bGVzOiBbXQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5wcm9wcy5oYW5kT2tWYWwgJiYgX3RoaXMucHJvcHMuaGFuZE9rVmFsKG5ld1F1ZXN0aW9uSXRlbSwgbik7CiAgICAgIH0KICAgIH07CgogICAgX3RoaXMuY2hvb3NlQm94ID0gZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgIHZhciBxdWVzdGlvblN0cnVjdHVyZSA9IF90aGlzLnN0YXRlLnF1ZXN0aW9uU3RydWN0dXJlOwogICAgICB2YXIgbmV3UXVlc3Rpb25TdHJ1Y3R1cmUgPSBxdWVzdGlvblN0cnVjdHVyZS5tYXAoZnVuY3Rpb24gKGl0ZW0sIGkpIHsKICAgICAgICBpZiAoaW5kZXggIT09IGkpIHsKICAgICAgICAgIGl0ZW0uaXNDaG9vc2UgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXRlbS5pc0Nob29zZSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpdGVtLnJlYWRPbmx5ID0gZmFsc2U7CiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHF1ZXN0aW9uU3RydWN0dXJlOiBuZXdRdWVzdGlvblN0cnVjdHVyZQogICAgICB9KTsKICAgIH07CgogICAgX3RoaXMuc2V0QW5zd2VyID0gZnVuY3Rpb24gKGUsIGVpKSB7CiAgICAgIHZhciBxdWVzdGlvblN0cnVjdHVyZSA9IF90aGlzLnN0YXRlLnF1ZXN0aW9uU3RydWN0dXJlOwogICAgICB2YXIgbmV3UXVlc3Rpb25TdHJ1Y3R1cmUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHF1ZXN0aW9uU3RydWN0dXJlKSkubWFwKGZ1bmN0aW9uIChxdWVzdGlvbkl0ZW0pIHsKICAgICAgICBpZiAocXVlc3Rpb25JdGVtLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICBxdWVzdGlvbkl0ZW0uY29udGVudCA9IGU7CiAgICAgICAgICBxdWVzdGlvbkl0ZW0uaXNGaWxsZWQgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHF1ZXN0aW9uSXRlbS50eXBlID09PSAnY29tcHJlaGVuc2l2ZScpIHsKICAgICAgICAgIHF1ZXN0aW9uSXRlbS5jb250ZW50W2VpXS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ2Fuc3dlcicpIHsKICAgICAgICAgICAgICBpdGVtLmNvbnRlbnQgPSBlOwogICAgICAgICAgICAgIGl0ZW0uaXNGaWxsZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBxdWVzdGlvbkl0ZW07CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZygnbmV3UXVlc3Rpb25TdHJ1Y3R1cmU9PT4nLCBuZXdRdWVzdGlvblN0cnVjdHVyZSk7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcXVlc3Rpb25TdHJ1Y3R1cmU6IG5ld1F1ZXN0aW9uU3RydWN0dXJlCiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5wcm9wcy5jaGFuZ2VBbnN3ZXIobmV3UXVlc3Rpb25TdHJ1Y3R1cmUpOwogICAgICB9KTsKICAgIH07CgogICAgX3RoaXMuZGVsZXRlT3B0aW9uID0gZnVuY3Rpb24gKGluZGV4LCBlaSkgewogICAgICB2YXIgX3RoaXMkc3RhdGUyID0gX3RoaXMuc3RhdGUsCiAgICAgICAgICBxdWVzdGlvblN0cnVjdHVyZSA9IF90aGlzJHN0YXRlMi5xdWVzdGlvblN0cnVjdHVyZSwKICAgICAgICAgIGlzQ2hhbmdlUXVlc3Rpb25MaXN0ID0gX3RoaXMkc3RhdGUyLmlzQ2hhbmdlUXVlc3Rpb25MaXN0OwogICAgICB2YXIgbmV3UXVlc3Rpb25TdHJ1Y3R1cmVzOwogICAgICB2YXIgaXNPbmx5T3B0aW9uID0gZmFsc2U7CiAgICAgIG5ld1F1ZXN0aW9uU3RydWN0dXJlcyA9IGdldEVtcHR5T3B0aW9uKGluZGV4LCBxdWVzdGlvblN0cnVjdHVyZSwgaXNPbmx5T3B0aW9uLCBlaSk7CgogICAgICBpZiAoZWkgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmIChpc0NoYW5nZVF1ZXN0aW9uTGlzdC5pbmRleE9mKGVpKSA9PT0gLTEpIHsKICAgICAgICAgIGlzQ2hhbmdlUXVlc3Rpb25MaXN0LnB1c2goZWkpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaXNDaGFuZ2VRdWVzdGlvbkxpc3QuaW5kZXhPZigtMSkgPT09IC0xKSB7CiAgICAgICAgICBpc0NoYW5nZVF1ZXN0aW9uTGlzdC5wdXNoKC0xKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChuZXdRdWVzdGlvblN0cnVjdHVyZXMuaXNPbmx5T3B0aW9uKSB7CiAgICAgICAgVGlwcy5vcGVuKHsKICAgICAgICAgIG1lc3NhZ2U6ICJcdTgxRjNcdTVDMTFcdTUzMDVcdTU0MkJcdTRFMjRcdTRFMkFcdTkwMDlcdTk4NzkiLAogICAgICAgICAgdHlwZTogJ2ZhaWwnCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgcXVlc3Rpb25TdHJ1Y3R1cmU6IG5ld1F1ZXN0aW9uU3RydWN0dXJlcy5uZXdRdWVzdGlvblN0cnVjdHVyZQogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgcXVlc3Rpb25TdHJ1Y3R1cmU6IG5ld1F1ZXN0aW9uU3RydWN0dXJlcy5uZXdRdWVzdGlvblN0cnVjdHVyZTEsCiAgICAgICAgICAgIGlzQ2hhbmdlUXVlc3Rpb25MaXN0OiBpc0NoYW5nZVF1ZXN0aW9uTGlzdAogICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzaG93TWF0aEpheCh0cnVlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9OwoKICAgIF90aGlzLmNhbGxiYWNrID0gZnVuY3Rpb24gKGtleSkgewogICAgICB2YXIgX3RoaXMkc3RhdGUzID0gX3RoaXMuc3RhdGUsCiAgICAgICAgICBxdWVzdGlvbkl0ZW0gPSBfdGhpcyRzdGF0ZTMucXVlc3Rpb25JdGVtLAogICAgICAgICAgcXVlc3Rpb25TdHJ1Y3R1cmUgPSBfdGhpcyRzdGF0ZTMucXVlc3Rpb25TdHJ1Y3R1cmUsCiAgICAgICAgICB0eXBlID0gX3RoaXMkc3RhdGUzLnR5cGU7CiAgICAgIHZhciBjaGFuZ2VWYWx1ZSA9IGdldFF1ZXN0aW9uSHRtbChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHF1ZXN0aW9uU3RydWN0dXJlKSksIHR5cGUpOwogICAgICB2YXIgZXJyS2V5ID0gY2hhbmdlVmFsdWUuZXJyTGlzdC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5pbmRleDsKICAgICAgfSk7CiAgICAgIGVycktleSA9IGVycktleS5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZSAhPT0gdW5kZWZpbmVkOwogICAgICB9KTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBhY3RpdmVLZXk6IGtleSwKICAgICAgICBlcnJMaXN0OiBlcnJLZXkKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIHNob3dNYXRoSmF4KHRydWUpOwogICAgICB9KTsKICAgIH07CgogICAgX3RoaXMucG9zdGlvbiA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBtb2RhbFBvc2l0aW9uOiBlCiAgICAgIH0pOwogICAgfTsKCiAgICBfdGhpcy5wb3NpdGlvbkluc2VydEZvcm11bGEgPSBmdW5jdGlvbiAoZSkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgbW9kYWxQb3NpdGlvbkluc2VydEZvcm11bGE6IGUKICAgICAgfSk7CiAgICB9OwoKICAgIF90aGlzLmNoYW5nZUl0ZW0gPSBmdW5jdGlvbiAob3B0aW9uKSB7CiAgICAgIHZhciBxdWVzdGlvblN0cnVjdHVyZSA9IF90aGlzLnN0YXRlLnF1ZXN0aW9uU3RydWN0dXJlOwoKICAgICAgdmFyIG5ld1F1ZXN0aW9uU3RydWN0dXJlID0gXy5tYXAocXVlc3Rpb25TdHJ1Y3R1cmUsIGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ2Fuc3dlcicpIHsKICAgICAgICAgIGl0ZW0ub3B0aW9uID0gXy5jbG9uZURlZXAob3B0aW9uKTsKICAgICAgICAgIGl0ZW0uY29udGVudCA9IFt7CiAgICAgICAgICAgIGNoaWxkcmVuOiBbewogICAgICAgICAgICAgIHRleHQ6IG9wdGlvblswXSwKICAgICAgICAgICAgICBzdHlsZXM6IFtdLAogICAgICAgICAgICAgIHR5cGU6ICdMZWZ0JwogICAgICAgICAgICB9XQogICAgICAgICAgfV07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcXVlc3Rpb25TdHJ1Y3R1cmU6IG5ld1F1ZXN0aW9uU3RydWN0dXJlCiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5wcm9wcy5jaGFuZ2VBbnN3ZXIobmV3UXVlc3Rpb25TdHJ1Y3R1cmUpOwogICAgICB9KTsgLy8gY29uc29sZS5sb2coJ3F1ZXN0aW9uU3RydWN0dXJlPT0+JywgcXVlc3Rpb25TdHJ1Y3R1cmUpOwoKICAgIH07CgogICAgX3RoaXMuY2FsY2VsQW5zd2VycyA9IGZ1bmN0aW9uIChpbmRleCwgaSkgewogICAgICB2YXIgX3RoaXMkc3RhdGU0ID0gX3RoaXMuc3RhdGUsCiAgICAgICAgICBxdWVzdGlvblN0cnVjdHVyZSA9IF90aGlzJHN0YXRlNC5xdWVzdGlvblN0cnVjdHVyZSwKICAgICAgICAgIHR5cGUgPSBfdGhpcyRzdGF0ZTQudHlwZTsKCiAgICAgIHZhciBuZXdRdWVzdGlvblN0cnVjdHVyZSA9IF8ubWFwKHF1ZXN0aW9uU3RydWN0dXJlLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdvcHRpb24nKSB7CiAgICAgICAgICBpdGVtLmNvbnRlbnQgPSBfLm1hcChpdGVtLmNvbnRlbnQsIGZ1bmN0aW9uIChlbCwgZWxpKSB7CiAgICAgICAgICAgIGlmIChlbGkgPT09IGkpIHsKICAgICAgICAgICAgICBlbCA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZWwpLCB7fSwgewogICAgICAgICAgICAgICAgaXNBbnN3ZXI6IGZhbHNlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBlbDsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwoKICAgICAgbmV3UXVlc3Rpb25TdHJ1Y3R1cmUgPSBfdGhpcy5nZXRBbnN3ZXJTdHJ1Y3R1cmUobmV3UXVlc3Rpb25TdHJ1Y3R1cmUpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHF1ZXN0aW9uU3RydWN0dXJlOiBuZXdRdWVzdGlvblN0cnVjdHVyZQogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMucHJvcHMuY2hhbmdlQW5zd2VyKG5ld1F1ZXN0aW9uU3RydWN0dXJlKTsKICAgICAgfSk7CiAgICB9OwoKICAgIF90aGlzLnNldEFuc3dlcnMgPSBmdW5jdGlvbiAoaW5kZXgsIGkpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlNSA9IF90aGlzLnN0YXRlLAogICAgICAgICAgcXVlc3Rpb25TdHJ1Y3R1cmUgPSBfdGhpcyRzdGF0ZTUucXVlc3Rpb25TdHJ1Y3R1cmUsCiAgICAgICAgICB0eXBlID0gX3RoaXMkc3RhdGU1LnR5cGU7CiAgICAgIGNvbnNvbGUubG9nKCduZXdRdWVzdGlvblN0cnVjdHVyZT09PicsIHF1ZXN0aW9uU3RydWN0dXJlKTsKCiAgICAgIHZhciBuZXdRdWVzdGlvblN0cnVjdHVyZSA9IF8ubWFwKHF1ZXN0aW9uU3RydWN0dXJlLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIC8vIOS/ruaUueaKpemUmeeahOeKtuaAgQogICAgICAgIGl0ZW0uaXNGaWxsZWQgPSB0cnVlOwoKICAgICAgICBpZiAoaXRlbS50eXBlID09PSAnb3B0aW9uJykgewogICAgICAgICAgaWYgKHR5cGUgPT09ICdTSU5HTEVfQ0hPSUNFJykgewogICAgICAgICAgICBpdGVtLmNvbnRlbnQgPSBfLm1hcChpdGVtLmNvbnRlbnQsIGZ1bmN0aW9uIChlbCwgZWxpKSB7CiAgICAgICAgICAgICAgaWYgKGVsaSA9PT0gaSkgewogICAgICAgICAgICAgICAgZWwgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGVsKSwge30sIHsKICAgICAgICAgICAgICAgICAgaXNBbnN3ZXI6IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbCA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZWwpLCB7fSwgewogICAgICAgICAgICAgICAgICBpc0Fuc3dlcjogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIGVsOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGl0ZW0uY29udGVudCA9IF8ubWFwKGl0ZW0uY29udGVudCwgZnVuY3Rpb24gKGVsLCBlbGkpIHsKICAgICAgICAgICAgICBpZiAoZWxpID09PSBpKSB7CiAgICAgICAgICAgICAgICBlbCA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZWwpLCB7fSwgewogICAgICAgICAgICAgICAgICBpc0Fuc3dlcjogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gZWw7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwoKICAgICAgbmV3UXVlc3Rpb25TdHJ1Y3R1cmUgPSBfdGhpcy5nZXRBbnN3ZXJTdHJ1Y3R1cmUocXVlc3Rpb25TdHJ1Y3R1cmUpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHF1ZXN0aW9uU3RydWN0dXJlOiBuZXdRdWVzdGlvblN0cnVjdHVyZQogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMucHJvcHMuY2hhbmdlQW5zd2VyKG5ld1F1ZXN0aW9uU3RydWN0dXJlKTsKICAgICAgfSk7CiAgICB9OwoKICAgIF90aGlzLmdldEFuc3dlclN0cnVjdHVyZSA9IGZ1bmN0aW9uIChuZXdRdWVzdGlvblN0cnVjdHVyZSkgewogICAgICB2YXIgY29udGVudEl0ZW0gPSBbXTsKICAgICAgbmV3UXVlc3Rpb25TdHJ1Y3R1cmUgPSBfLm1hcChuZXdRdWVzdGlvblN0cnVjdHVyZSwgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpZiAoaXRlbS50eXBlID09PSAnb3B0aW9uJykgewogICAgICAgICAgaXRlbS5jb250ZW50ID0gXy5tYXAoaXRlbS5jb250ZW50LCBmdW5jdGlvbiAoZWwsIGVsaSkgewogICAgICAgICAgICBpZiAoZWwuaXNBbnN3ZXIpIHsKICAgICAgICAgICAgICBjb250ZW50SXRlbS5wdXNoKHsKICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbewogICAgICAgICAgICAgICAgICB0ZXh0OiBvcHRpb25WYWx1ZVtlbGldCiAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgIHN0eWxlczogW10sCiAgICAgICAgICAgICAgICB0eXBlOiAnTGVmdCcKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGVsOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CiAgICAgIG5ld1F1ZXN0aW9uU3RydWN0dXJlID0gXy5tYXAobmV3UXVlc3Rpb25TdHJ1Y3R1cmUsIGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ2Fuc3dlcicpIHsKICAgICAgICAgIGl0ZW0uY29udGVudCA9IF8uY2xvbmVEZWVwKGNvbnRlbnRJdGVtKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBpdGVtOwogICAgICB9KTsKICAgICAgcmV0dXJuIG5ld1F1ZXN0aW9uU3RydWN0dXJlOwogICAgfTsKCiAgICBfdGhpcy5hZGRBbnN3ZXJzID0gZnVuY3Rpb24gKGluZGV4LCBpKSB7CiAgICAgIHZhciBxdWVzdGlvblN0cnVjdHVyZSA9IF90aGlzLnN0YXRlLnF1ZXN0aW9uU3RydWN0dXJlOwoKICAgICAgdmFyIG5ld1F1ZXN0aW9uU3RydWN0dXJlID0gXy5jbG9uZURlZXAocXVlc3Rpb25TdHJ1Y3R1cmUpOyAvLyBjb25zb2xlLmxvZygncXVlc3Rpb25TdHJ1Y3R1cmU9PT09PicsIF8uY2xvbmVEZWVwKHF1ZXN0aW9uU3RydWN0dXJlKSk7CgoKICAgICAgdmFyIGNvbnRlbnRzID0gbmV3UXVlc3Rpb25TdHJ1Y3R1cmVbaW5kZXhdWydjb250ZW50J107CiAgICAgIG5ld1F1ZXN0aW9uU3RydWN0dXJlW2luZGV4XVsnY29udGVudCddID0gXy5tYXAoY29udGVudHMsIGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaXRlbSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgaXRlbSksIHt9LCB7CiAgICAgICAgICBhdXRvRm9jdXM6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwogICAgICBuZXdRdWVzdGlvblN0cnVjdHVyZVtpbmRleF1bJ2NvbnRlbnQnXS5zcGxpY2UoaSArIDEsIDAsIHsKICAgICAgICBjaGlsZHJlbjogW3sKICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgaXNBZGQ6IHRydWUKICAgICAgICB9XSwKICAgICAgICBpc0ZpbGxlZDogdHJ1ZSwKICAgICAgICBhdXRvRm9jdXM6IHRydWUsCiAgICAgICAga2V5OiBTdHJpbmcoTWF0aC5yYW5kb20oKSkucmVwbGFjZSgnXC4nLCAnJyksCiAgICAgICAgcmVxdWlyZVRleHQ6ICLlhoXlrrnkuI3og73kuLrnqboiLAogICAgICAgIHN0eWxlczogW10sCiAgICAgICAgdHlwZTogJ0xlZnQnCiAgICAgIH0pOwoKICAgICAgX3RoaXMucHJvcHMuY2hhbmdlQW5zd2VyKF8uY2xvbmVEZWVwKG5ld1F1ZXN0aW9uU3RydWN0dXJlKSk7CiAgICB9OwoKICAgIF90aGlzLmRlbGV0ZUFuc3dlcnMgPSBmdW5jdGlvbiAoaW5kZXgsIGkpIHsKICAgICAgdmFyIHF1ZXN0aW9uU3RydWN0dXJlID0gX3RoaXMuc3RhdGUucXVlc3Rpb25TdHJ1Y3R1cmU7CiAgICAgIHF1ZXN0aW9uU3RydWN0dXJlW2luZGV4XVsnY29udGVudCddLnNwbGljZShpLCAxKTsKICAgICAgdmFyIGNvbnRlbnQgPSBxdWVzdGlvblN0cnVjdHVyZVtpbmRleF1bJ2NvbnRlbnQnXS5sZW5ndGg7IC8vIEB0cy1pZ25vcmUKCiAgICAgIHZhciBvcHRpb24gPSBvcHRpb25WYWx1ZS5maWx0ZXIoZnVuY3Rpb24gKGVsLCBpbmRleCkgewogICAgICAgIHJldHVybiBpbmRleCA8IGNvbnRlbnQ7CiAgICAgIH0pOyAvLyDliKDpmaTnmoTml7blgJnvvIzlr7nnrZTmoYjov5vooYzlpITnkIYKCiAgICAgIHF1ZXN0aW9uU3RydWN0dXJlID0gXy5tYXAocXVlc3Rpb25TdHJ1Y3R1cmUsIGZ1bmN0aW9uIChlbCkgewogICAgICAgIGlmIChlbC50eXBlID09PSAnYW5zd2VyJykgewogICAgICAgICAgLy8gY29uc29sZS5sb2codmFsdWUpOwogICAgICAgICAgLy8g6K6w5b2V5L+u5pS555qE6aKYCiAgICAgICAgICAvLyDliKTmlq3mmK/lkKbkuLrnqbrnmoQKICAgICAgICAgIGVsLmNvbnRlbnQgPSBlbC5jb250ZW50Lm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICBpdGVtLmNoaWxkcmVuID0gaXRlbS5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgdGV4dCA9ICcnOwogICAgICAgICAgICAgIHZhciByZXN1bHQgPSBlLnRleHQgPyBlLnRleHQucmVwbGFjZSgvKF5ccyopfChccyokKS9nLCAnJykgOiAnJzsKCiAgICAgICAgICAgICAgaWYgKGUuY2hhcmFjdGVyKSB7CiAgICAgICAgICAgICAgICByZXN1bHQgKz0gZS5jaGFyYWN0ZXIgPyBlLmNoYXJhY3Rlci5yZXBsYWNlKC8oXlxzKil8KFxzKiQpL2csICcnKSA6ICcnOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGV4dCArPSByZXN1bHQ7CiAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi5pbmNsdWRlcyh0ZXh0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGl0ZW0ub3B0aW9uID0gXy5jbG9uZURlZXAob3B0aW9uKTsKICAgICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBlbDsKICAgICAgfSk7CgogICAgICB2YXIgbmV3UXVlc3Rpb25TdHJ1Y3R1cmUgPSBfdGhpcy5nZXRBbnN3ZXJTdHJ1Y3R1cmUocXVlc3Rpb25TdHJ1Y3R1cmUpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHF1ZXN0aW9uU3RydWN0dXJlOiBuZXdRdWVzdGlvblN0cnVjdHVyZQogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMucHJvcHMuY2hhbmdlQW5zd2VyKF8uY2xvbmVEZWVwKG5ld1F1ZXN0aW9uU3RydWN0dXJlKSk7CiAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgX3ZpZGVvVXJsID0gZ2V0VmlkZW9VcmwocHJvcHMudmFsdWUucXVlc3Rpb24pOwoKICAgIF90aGlzLnN0YXRlID0gewogICAgICBxdWVzdGlvblJlbmRlckNvbXBsZXRlZDogZmFsc2UsCiAgICAgIHF1ZXN0aW9uSXRlbTogSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwcm9wcy52YWx1ZSkpLAogICAgICAvLyBpbml0VmFsOiBpbml0VmFsLAogICAgICBxdWVzdGlvblN0cnVjdHVyZTogcHJvcHMucXVlc3Rpb25TdHJ1Y3R1cmUsCiAgICAgIHR5cGU6IHByb3BzLnZhbHVlLnF1ZXN0aW9uLnF1ZXN0aW9uVHlwZSwKICAgICAgLy8gdmFsdWU6IGluaXRWYWwsCiAgICAgIGFjdGl2ZUtleTogJzAnLAogICAgICBhbnN3ZXI6IFsnQSddLAogICAgICBlcnJMaXN0OiBbXSwKICAgICAgaXNDaGFuZ2VRdWVzdGlvbkxpc3Q6IHByb3BzLnZhbHVlLnF1ZXN0aW9uLmlzQ2hhbmdlUXVlc3Rpb25MaXN0IHx8IFtdLAogICAgICBoYXNFcnJvcjogZmFsc2UsCiAgICAgIG9yZGVyU29ydFZpc2libGU6IGZhbHNlLAogICAgICBtb2RhbFBvc2l0aW9uOiB7CiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgQWN0aXZlS2V5OiAnMCcsCiAgICAgICAgbGVmdDogJ2NhbGMoNTAlIC0gMjAwcHgpJywKICAgICAgICB0b3A6ICdjYWxjKDUwdmggLSAyMDdweCknCiAgICAgIH0sCiAgICAgIG1vZGFsUG9zaXRpb25JbnNlcnRGb3JtdWxhOiB7CiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgQWN0aXZlS2V5OiAnMCcsCiAgICAgICAgbGVmdDogJ2NhbGMoNTAlIC0gNTAwcHgpJywKICAgICAgICB0b3A6ICdjYWxjKDUwdmggLSAyMDBweCknCiAgICAgIH0sCiAgICAgIGNvbG9yOiAnYmxhY2snLAogICAgICBzb3J0Rm9ybWF0OiAnMScsCiAgICAgIGlzSW5Cb3g6IGZhbHNlLAogICAgICAvLyDmmK/lkKbogZrnhKblnKjovpPlhaXmoYblhoUKICAgICAgdmlkZW9Vcmw6IF92aWRlb1VybAogICAgfTsKICAgIF90aGlzLmNoYW5nZVZhbHVlID0gZGVib3VuY2UoX3RoaXMuY2hhbmdlVmFsdWUsIDEwMCk7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRWRpdEl0ZW0sIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIHZhciBfZG9jdW1lbnQkZ2V0RWxlbWVudEI7CgogICAgICBzaG93TWF0aEpheCgpOwogICAgICAoX2RvY3VtZW50JGdldEVsZW1lbnRCID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ1JpY2hUZXh0JykpID09PSBudWxsIHx8IF9kb2N1bWVudCRnZXRFbGVtZW50QiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RvY3VtZW50JGdldEVsZW1lbnRCLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBxdWVzdGlvblN0cnVjdHVyZSA9IG5leHRQcm9wcy5xdWVzdGlvblN0cnVjdHVyZTsKCiAgICAgIGlmIChKU09OLnN0cmluZ2lmeSh0aGlzLnN0YXRlLnF1ZXN0aW9uU3RydWN0dXJlKSAhPT0gSlNPTi5zdHJpbmdpZnkocXVlc3Rpb25TdHJ1Y3R1cmUpKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coJ3F1ZXN0aW9uU3RydWN0dXJlPT09PT4nLCBxdWVzdGlvblN0cnVjdHVyZSk7CiAgICAgICAgLy8gbGV0IHRyYW5zaXRpb25RdWVzdGlvblN0cnVjdHVyZSA9IF8ubWFwKF8uY2xvbmVEZWVwKHF1ZXN0aW9uU3RydWN0dXJlKSwgKGVsOiBhbnkpID0+IHsKICAgICAgICAvLyAgICAgZWwuY29udGVudCA9IFtdOwogICAgICAgIC8vICAgICByZXR1cm4gZWw7CiAgICAgICAgLy8gfSk7CiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBxdWVzdGlvblN0cnVjdHVyZTogW10KICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBxdWVzdGlvblN0cnVjdHVyZTogcXVlc3Rpb25TdHJ1Y3R1cmUsCiAgICAgICAgICAgIHR5cGU6IG5leHRQcm9wcy52YWx1ZS5xdWVzdGlvbi5xdWVzdGlvblR5cGUKICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgc2hvd01hdGhKYXgodHJ1ZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNvbXBvbmVudERpZENhdGNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRDYXRjaCgpIHsKICAgICAgdmFyIGhhc0Vycm9yID0gdGhpcy5zdGF0ZS5oYXNFcnJvcjsKICAgICAgVGlwcy5vcGVuKHsKICAgICAgICBtZXNzYWdlOiAiXHU4RjkzXHU1MTY1XHU5NTE5XHU4QkVGXHVGRjBDXHU4QkY3XHU5MUNEXHU2NUIwXHU4RjkzXHU1MTY1XHVGRjAxIiwKICAgICAgICB0eXBlOiAnZmFpbCcsCiAgICAgICAgdGltZTogNTAwCiAgICAgIH0pOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBoYXNFcnJvcjogIWhhc0Vycm9yCiAgICAgIH0pOwogICAgICBzaG93TWF0aEpheCh0cnVlKTsKICAgIH0gLy8g54i257uE5Lu26Kem54qvCgogIH0sIHsKICAgIGtleTogIlJpY2hUZXh0UmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBSaWNoVGV4dFJlbmRlcihpdGVtLCBpbmRleCwgZWkpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkc3RhdGU2ID0gdGhpcy5zdGF0ZSwKICAgICAgICAgIG1vZGFsUG9zaXRpb24gPSBfdGhpcyRzdGF0ZTYubW9kYWxQb3NpdGlvbiwKICAgICAgICAgIGNvbG9yID0gX3RoaXMkc3RhdGU2LmNvbG9yLAogICAgICAgICAgc29ydEZvcm1hdCA9IF90aGlzJHN0YXRlNi5zb3J0Rm9ybWF0LAogICAgICAgICAgbW9kYWxQb3NpdGlvbkluc2VydEZvcm11bGEgPSBfdGhpcyRzdGF0ZTYubW9kYWxQb3NpdGlvbkluc2VydEZvcm11bGEsCiAgICAgICAgICBpc0luQm94ID0gX3RoaXMkc3RhdGU2LmlzSW5Cb3g7CiAgICAgIHZhciBzZWFyY2ggPSB0aGlzLnByb3BzLnNlYXJjaDsKICAgICAgdmFyIHJlbmRlckRvbTsKCiAgICAgIGlmIChpdGVtLnR5cGUgIT09ICdvcHRpb24nICYmIGl0ZW0udHlwZSAhPT0gJ2Fuc3dlcicpIHsKICAgICAgICByZW5kZXJEb20gPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgX19zZWxmOiB0aGlzLAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogNjUwLAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDI1CiAgICAgICAgICB9CiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogIWl0ZW0uaXNGaWxsZWQgJiYgaXRlbS5yZXF1aXJlID8gJ2JveEVycm9yJyA6ICdSaWNoVGV4dElucHV0JywKICAgICAgICAgIF9fc2VsZjogdGhpcywKICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgIGxpbmVOdW1iZXI6IDY1MSwKICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAxNwogICAgICAgICAgfQogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJpY2hUZXh0LCB7CiAgICAgICAgICBzZWFyY2g6IHNlYXJjaCwKICAgICAgICAgIHZhbHVlOiBpdGVtLmNvbnRlbnQsCiAgICAgICAgICBpc0Zpc3RSaWNoOiBpdGVtLmlzRmlzdFJpY2gsCiAgICAgICAgICBtaW5IZWlnaHQ6IDYzLAogICAgICAgICAgaWQ6ICIiLmNvbmNhdChpbmRleCkuY29uY2F0KGVpKSwKICAgICAgICAgIGNoYW5nZVZhbHVlOiBmdW5jdGlvbiBjaGFuZ2VWYWx1ZShlKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczMuY2hhbmdlVmFsdWUoZSwgW2luZGV4XSwgZWkpOwogICAgICAgICAgfSwKICAgICAgICAgIHBvc3Rpb246IGZ1bmN0aW9uIHBvc3Rpb24oZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMzLnBvc3Rpb24oZSk7CiAgICAgICAgICB9LAogICAgICAgICAgcG9zaXRpb25JbnNlcnRGb3JtdWxhOiBmdW5jdGlvbiBwb3NpdGlvbkluc2VydEZvcm11bGEoZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMzLnBvc2l0aW9uSW5zZXJ0Rm9ybXVsYShlKTsKICAgICAgICAgIH0sCiAgICAgICAgICBtb2RhbFBvc2l0aW9uOiBtb2RhbFBvc2l0aW9uLAogICAgICAgICAgbW9kYWxQb3NpdGlvbkluc2VydEZvcm11bGE6IG1vZGFsUG9zaXRpb25JbnNlcnRGb3JtdWxhLAogICAgICAgICAgY2hhbmdlQ29sb3I6IGZ1bmN0aW9uIGNoYW5nZUNvbG9yKGNvbG9yKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczMuc2V0U3RhdGUoewogICAgICAgICAgICAgIGNvbG9yOiBjb2xvcgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sCiAgICAgICAgICBjb2xvcjogY29sb3IsCiAgICAgICAgICBzb3J0Rm9ybWF0OiBzb3J0Rm9ybWF0LAogICAgICAgICAgc2V0Rm9ybWF0OiBmdW5jdGlvbiBzZXRGb3JtYXQoZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgICBzb3J0Rm9ybWF0OiBlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwKICAgICAgICAgIGlzSW5Cb3g6IGlzSW5Cb3gsCiAgICAgICAgICBfX3NlbGY6IHRoaXMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA2NTIsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogMjEKICAgICAgICAgIH0KICAgICAgICB9KSksICFpdGVtLmlzRmlsbGVkICYmIGl0ZW0ucmVxdWlyZSA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICdlcnJvcicsCiAgICAgICAgICBfX3NlbGY6IHRoaXMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA2NzIsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNTEKICAgICAgICAgIH0KICAgICAgICB9LCBpdGVtLnJlcXVpcmVUZXh0KSA6ICcnKTsKICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgIT09ICdhbnN3ZXInKSB7CiAgICAgICAgcmVuZGVyRG9tID0gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogIm9wdGlvbkNvbnRhaW4iLAogICAgICAgICAgX19zZWxmOiB0aGlzLAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogNjc3LAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDI1CiAgICAgICAgICB9CiAgICAgICAgfSwgaXRlbS5jb250ZW50Lm1hcChmdW5jdGlvbiAoY29udGVudEl0ZW0sIGkpIHsKICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBrZXk6IGNvbnRlbnRJdGVtLmtleSB8fCBpLAogICAgICAgICAgICBjbGFzc05hbWU6ICdvcHRpb25Cb3gxJywKICAgICAgICAgICAgX19zZWxmOiBfdGhpczMsCiAgICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgICBsaW5lTnVtYmVyOiA2ODAsCiAgICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAzMgogICAgICAgICAgICB9CiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICdvcHRpb25JdGVtJywKICAgICAgICAgICAgX19zZWxmOiBfdGhpczMsCiAgICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgICBsaW5lTnVtYmVyOiA2ODMsCiAgICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAyOQogICAgICAgICAgICB9CiAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICdyaWNodGV4dCcuY29uY2F0KCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25Db250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiwgIWNvbnRlbnRJdGVtLmlzRmlsbGVkID8gJ2JveEVycm9yJyA6ICdSaWNoVGV4dElucHV0JywgIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIpLmNvbmNhdChjb250ZW50SXRlbS5pc0Fuc3dlciA/ICdpc0Fuc3dlcicgOiAnJywgIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiksCiAgICAgICAgICAgIGlkOiBjb250ZW50SXRlbVsnYXV0b0ZvY3VzJ10gPyAnYXV0b0ZvY3VzJyA6ICcnLAogICAgICAgICAgICBfX3NlbGY6IF90aGlzMywKICAgICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICAgIGxpbmVOdW1iZXI6IDY4OSwKICAgICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDMzCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogImFuc3dlck9wdGF0ZSIsCiAgICAgICAgICAgIF9fc2VsZjogX3RoaXMzLAogICAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgICAgbGluZU51bWJlcjogNjk2LAogICAgICAgICAgICAgIGNvbHVtbk51bWJlcjogMzcKICAgICAgICAgICAgfQogICAgICAgICAgfSwgaXRlbS5jb250ZW50Lmxlbmd0aCA+IDIgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJjYW5jZWxzd2VyIiwKICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLmRlbGV0ZUFuc3dlcnMoaW5kZXgsIGkpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBfX3NlbGY6IF90aGlzMywKICAgICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICAgIGxpbmVOdW1iZXI6IDY5OCwKICAgICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDcxCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sICJcdTUyMjBcdTk2NjQiKSA6ICcnLCAhY29udGVudEl0ZW0uaXNBbnN3ZXIgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJhbnN3ZXIiLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpczMuc2V0QW5zd2VycyhpbmRleCwgaSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF9fc2VsZjogX3RoaXMzLAogICAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgICAgbGluZU51bWJlcjogNzAyLAogICAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNDkKICAgICAgICAgICAgfQogICAgICAgICAgfSwgIlx1OEJCRVx1NEUzQVx1N0I1NFx1Njg0OCIpIDogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYW5zd2VyIiwKICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLmNhbGNlbEFuc3dlcnMoaW5kZXgsIGkpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBfX3NlbGY6IF90aGlzMywKICAgICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICAgIGxpbmVOdW1iZXI6IDcwMywKICAgICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDUxCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sICJcdTUzRDZcdTZEODhcdTdCNTRcdTY4NDgiKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiYWRkc3dlciIsCiAgICAgICAgICAgIG9uTW91c2VVcDogZnVuY3Rpb24gb25Nb3VzZVVwKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpczMuYWRkQW5zd2VycyhpbmRleCwgaSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF9fc2VsZjogX3RoaXMzLAogICAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgICAgbGluZU51bWJlcjogNzA1LAogICAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNDEKICAgICAgICAgICAgfQogICAgICAgICAgfSwgIlx1NjVCMFx1NTg5RSIpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmljaFRleHQsIHsKICAgICAgICAgICAgc2VhcmNoOiBzZWFyY2gsCiAgICAgICAgICAgIGluZGV4OiBjb250ZW50SXRlbVsnS2V5J10sCiAgICAgICAgICAgIHZhbHVlOiBbY29udGVudEl0ZW1dLAogICAgICAgICAgICBhdXRvRm9jdXM6IGNvbnRlbnRJdGVtWydhdXRvRm9jdXMnXSwKICAgICAgICAgICAgaXNvcHRpb246IHRydWUsCiAgICAgICAgICAgIGlzT3B0aW9uOiB0cnVlLAogICAgICAgICAgICBpZDogIiIuY29uY2F0KGluZGV4KS5jb25jYXQoaSksCiAgICAgICAgICAgIGlzRmlsbGVkOiBjb250ZW50SXRlbS5pc0ZpbGxlZCwKICAgICAgICAgICAgY2hhbmdlVmFsdWU6IGZ1bmN0aW9uIGNoYW5nZVZhbHVlKGUpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLmNoYW5nZVZhbHVlKGUsIFtpbmRleCwgaV0sIGVpKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcG9zdGlvbjogZnVuY3Rpb24gcG9zdGlvbihlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5wb3N0aW9uKGUpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBwb3NpdGlvbkluc2VydEZvcm11bGE6IGZ1bmN0aW9uIHBvc2l0aW9uSW5zZXJ0Rm9ybXVsYShlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5wb3NpdGlvbkluc2VydEZvcm11bGEoZSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG1vZGFsUG9zaXRpb246IG1vZGFsUG9zaXRpb24sCiAgICAgICAgICAgIG1vZGFsUG9zaXRpb25JbnNlcnRGb3JtdWxhOiBtb2RhbFBvc2l0aW9uSW5zZXJ0Rm9ybXVsYSwKICAgICAgICAgICAgY2hhbmdlQ29sb3I6IGZ1bmN0aW9uIGNoYW5nZUNvbG9yKGNvbG9yKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3IKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY29sb3I6IGNvbG9yLAogICAgICAgICAgICBzb3J0Rm9ybWF0OiBzb3J0Rm9ybWF0LAogICAgICAgICAgICBzZXRGb3JtYXQ6IGZ1bmN0aW9uIHNldEZvcm1hdChlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzb3J0Rm9ybWF0OiBlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGlzSW5Cb3g6IGlzSW5Cb3gsCiAgICAgICAgICAgIF9fc2VsZjogX3RoaXMzLAogICAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgICAgbGluZU51bWJlcjogNzA3LAogICAgICAgICAgICAgIGNvbHVtbk51bWJlcjogMzcKICAgICAgICAgICAgfQogICAgICAgICAgfSkpKSwgIWNvbnRlbnRJdGVtLmlzRmlsbGVkID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXJyb3InLAogICAgICAgICAgICBfX3NlbGY6IF90aGlzMywKICAgICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICAgIGxpbmVOdW1iZXI6IDczMCwKICAgICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDU0CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIGNvbnRlbnRJdGVtLnJlcXVpcmVUZXh0KSA6ICcnKTsKICAgICAgICB9KSk7CiAgICAgIH0gZWxzZSBpZiAoaXRlbS50eXBlID09PSAnYW5zd2VyJyAmJiBpdGVtLnF1ZXN0aW9uVHlwZSAhPT0gJ1NJTkdMRV9DSE9JQ0UnICYmIGl0ZW0ucXVlc3Rpb25UeXBlICE9PSAnTVVMVElQTEVfQ0hPSUNFJyAmJiBpdGVtLnF1ZXN0aW9uVHlwZSAhPT0gJ0lOREVGSU5JVEVfQ0hPSUNFJykgewogICAgICAgIHJlbmRlckRvbSA9IGl0ZW0uaXNDaG9pY2UgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgX19zZWxmOiB0aGlzLAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogNzQzLAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDQxCiAgICAgICAgICB9CiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ2hvaWNlQW5zd2VyLCB7CiAgICAgICAgICBhbnN3ZXI6IGl0ZW0uY29udGVudCwKICAgICAgICAgIG9wdGlvbjogaXRlbS5vcHRpb24sCiAgICAgICAgICBxdWVzdGlvblR5cGU6IGl0ZW0ucXVlc3Rpb25UeXBlLAogICAgICAgICAgc2V0QW5zd2VyOiBmdW5jdGlvbiBzZXRBbnN3ZXIoZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMzLnNldEFuc3dlcihlLCBlaSk7CiAgICAgICAgICB9LAogICAgICAgICAgX19zZWxmOiB0aGlzLAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogNzQ0LAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDE3CiAgICAgICAgICB9CiAgICAgICAgfSksICFpdGVtLmlzRmlsbGVkICYmIGl0ZW0ucmVxdWlyZSA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICdlcnJvcicsCiAgICAgICAgICBfX3NlbGY6IHRoaXMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA3NTEsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNTQKICAgICAgICAgIH0KICAgICAgICB9LCBpdGVtLnJlcXVpcmVUZXh0KSA6ICcnKSA6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBfX3NlbGY6IHRoaXMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA3NTMsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogMjIKICAgICAgICAgIH0KICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAhaXRlbS5pc0ZpbGxlZCAmJiBpdGVtLnJlcXVpcmUgPyAnYm94RXJyb3InIDogJ1JpY2hUZXh0SW5wdXQnLAogICAgICAgICAgX19zZWxmOiB0aGlzLAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogNzU0LAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDIxCiAgICAgICAgICB9CiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmljaFRleHQsIHsKICAgICAgICAgIHNlYXJjaDogc2VhcmNoLAogICAgICAgICAgdmFsdWU6IGl0ZW0uY29udGVudCwKICAgICAgICAgIGlzRmlzdFJpY2g6IGl0ZW0uaXNGaXN0UmljaCwKICAgICAgICAgIG1pbkhlaWdodDogNjMsCiAgICAgICAgICBpZDogIiIuY29uY2F0KGluZGV4KS5jb25jYXQoZWkpLAogICAgICAgICAgY2hhbmdlVmFsdWU6IGZ1bmN0aW9uIGNoYW5nZVZhbHVlKGUpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5jaGFuZ2VWYWx1ZShlLCBbaW5kZXhdLCBlaSwgJ2Fuc3dlcicpOwogICAgICAgICAgfSwKICAgICAgICAgIHBvc3Rpb246IGZ1bmN0aW9uIHBvc3Rpb24oZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMzLnBvc3Rpb24oZSk7CiAgICAgICAgICB9LAogICAgICAgICAgcG9zaXRpb25JbnNlcnRGb3JtdWxhOiBmdW5jdGlvbiBwb3NpdGlvbkluc2VydEZvcm11bGEoZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMzLnBvc2l0aW9uSW5zZXJ0Rm9ybXVsYShlKTsKICAgICAgICAgIH0sCiAgICAgICAgICBtb2RhbFBvc2l0aW9uOiBtb2RhbFBvc2l0aW9uLAogICAgICAgICAgbW9kYWxQb3NpdGlvbkluc2VydEZvcm11bGE6IG1vZGFsUG9zaXRpb25JbnNlcnRGb3JtdWxhLAogICAgICAgICAgY2hhbmdlQ29sb3I6IGZ1bmN0aW9uIGNoYW5nZUNvbG9yKGNvbG9yKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczMuc2V0U3RhdGUoewogICAgICAgICAgICAgIGNvbG9yOiBjb2xvcgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sCiAgICAgICAgICBjb2xvcjogY29sb3IsCiAgICAgICAgICBzb3J0Rm9ybWF0OiBzb3J0Rm9ybWF0LAogICAgICAgICAgc2V0Rm9ybWF0OiBmdW5jdGlvbiBzZXRGb3JtYXQoZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgICBzb3J0Rm9ybWF0OiBlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwKICAgICAgICAgIGlzSW5Cb3g6IGlzSW5Cb3gsCiAgICAgICAgICBfX3NlbGY6IHRoaXMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA3NTYsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogMjUKICAgICAgICAgIH0KICAgICAgICB9KSksICFpdGVtLmlzRmlsbGVkICYmIGl0ZW0ucmVxdWlyZSA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICdlcnJvcicsCiAgICAgICAgICBfX3NlbGY6IHRoaXMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA3NzYsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNTUKICAgICAgICAgIH0KICAgICAgICB9LCBpdGVtLnJlcXVpcmVUZXh0KSA6ICcnKTsKICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgcmVuZGVyRG9tID0gaXRlbS5pc0Nob2ljZSA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBfX3NlbGY6IHRoaXMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA3ODAsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNDEKICAgICAgICAgIH0KICAgICAgICB9LCAhaXRlbS5pc0ZpbGxlZCAmJiBpdGVtLnJlcXVpcmUgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAnZXJyb3InLAogICAgICAgICAgX19zZWxmOiB0aGlzLAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogNzgzLAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDU0CiAgICAgICAgICB9CiAgICAgICAgfSwgaXRlbS5yZXF1aXJlVGV4dCkgOiAnJykgOiAnJzsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlbmRlckRvbTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkc3RhdGU3ID0gdGhpcy5zdGF0ZSwKICAgICAgICAgIHF1ZXN0aW9uU3RydWN0dXJlID0gX3RoaXMkc3RhdGU3LnF1ZXN0aW9uU3RydWN0dXJlLAogICAgICAgICAgZXJyTGlzdCA9IF90aGlzJHN0YXRlNy5lcnJMaXN0LAogICAgICAgICAgYWN0aXZlS2V5ID0gX3RoaXMkc3RhdGU3LmFjdGl2ZUtleSwKICAgICAgICAgIGhhc0Vycm9yID0gX3RoaXMkc3RhdGU3Lmhhc0Vycm9yLAogICAgICAgICAgdmlkZW9VcmwgPSBfdGhpcyRzdGF0ZTcudmlkZW9Vcmw7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsCiAgICAgICAgICBjb3B5UXVlc3Rpb25Nb2RlID0gX3RoaXMkcHJvcHMuY29weVF1ZXN0aW9uTW9kZSwKICAgICAgICAgIHJlbmRlckRPTSA9IF90aGlzJHByb3BzLnJlbmRlckRPTTsKCiAgICAgIHZhciB0b3BpY0NvbnRlbnQgPSBmdW5jdGlvbiB0b3BpY0NvbnRlbnQoaXRlbSwgaW5kZXgsIGVpKSB7CiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBrZXk6IGluZGV4LAogICAgICAgICAgX19zZWxmOiBfdGhpczQsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA3OTcsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNjUKICAgICAgICAgIH0KICAgICAgICB9LCBpdGVtLnR5cGUgPT09ICdhbnN3ZXInICYmIChpdGVtLnF1ZXN0aW9uVHlwZSA9PT0gJ1NJTkdMRV9DSE9JQ0UnIHx8IGl0ZW0ucXVlc3Rpb25UeXBlID09PSAnTVVMVElQTEVfQ0hPSUNFJyB8fCBpdGVtLnF1ZXN0aW9uVHlwZSA9PT0gJ0lOREVGSU5JVEVfQ0hPSUNFJykgPyAnJyA6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICd0aXRsZScsCiAgICAgICAgICBfX3NlbGY6IF90aGlzNCwKICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgIGxpbmVOdW1iZXI6IDgwMywKICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAyNgogICAgICAgICAgfQogICAgICAgIH0sIGl0ZW0ucmVxdWlyZSA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgewogICAgICAgICAgY2xhc3NOYW1lOiAncmVxdWlyZScsCiAgICAgICAgICBfX3NlbGY6IF90aGlzNCwKICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgIGxpbmVOdW1iZXI6IDgwNCwKICAgICAgICAgICAgY29sdW1uTnVtYmVyOiA0MQogICAgICAgICAgfQogICAgICAgIH0sICIqIikgOiAnJywgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICBfX3NlbGY6IF90aGlzNCwKICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgIGxpbmVOdW1iZXI6IDgwNiwKICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAyNQogICAgICAgICAgfQogICAgICAgIH0sIGl0ZW0udGl0bGUpLCBpdGVtLnR5cGUgPT09ICdzdGVtJyAmJiBjb3B5UXVlc3Rpb25Nb2RlID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJjb3B5UXVlc3Rpb24iLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5wcm9wcy5jYW5jZWxDb3B5OwogICAgICAgICAgfSwKICAgICAgICAgIF9fc2VsZjogX3RoaXM0LAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogODA5LAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDMzCiAgICAgICAgICB9CiAgICAgICAgfSwgIlx1NTNENlx1NkQ4OCIsIGNvcHlRdWVzdGlvbk1vZGUgPT09IDEgPyAn5aSN5Yi2JyA6ICflvJXnlKgnKSA6ICcnLCBpdGVtLnR5cGUgPT09ICdvcHRpb24nID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICdjaG9pY2VUaXBzJywKICAgICAgICAgIF9fc2VsZjogX3RoaXM0LAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogODE3LAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDUxCiAgICAgICAgICB9CiAgICAgICAgfSwgcXVlc3Rpb25UeXBlVGV4dFtpdGVtWydxdWVzdGlvblR5cGUnXV0pIDogJycsIGl0ZW0ucXVlc3Rpb25UeXBlID09PSAnSlVER0VNRU5UJyAmJiBpdGVtLnR5cGUgPT09ICdhbnN3ZXInID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoSnVkZ2VtZW50QW5zd2VyLCB7CiAgICAgICAgICBvcHRpb246IGl0ZW0ub3B0aW9uLAogICAgICAgICAgY2hhbmdlSXRlbTogZnVuY3Rpb24gY2hhbmdlSXRlbShpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczQuY2hhbmdlSXRlbShpdGVtKTsKICAgICAgICAgIH0sCiAgICAgICAgICBfX3NlbGY6IF90aGlzNCwKICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgIGxpbmVOdW1iZXI6IDgxOSwKICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAyOQogICAgICAgICAgfQogICAgICAgIH0pIDogJycpLCBfdGhpczQuUmljaFRleHRSZW5kZXIoaXRlbSwgaW5kZXgsIGVpKSwgaXRlbS50eXBlID09PSAnc3RlbScgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAiYWRkUXVlc3Rpb25JdGVtIiwKICAgICAgICAgIF9fc2VsZjogX3RoaXM0LAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogODI5LAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDIxCiAgICAgICAgICB9CiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICdxdWVzdGlvblR5cGUnLAogICAgICAgICAgX19zZWxmOiBfdGhpczQsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA4MzEsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogMjUKICAgICAgICAgIH0KICAgICAgICB9LCByZW5kZXJET00gJiYgcmVuZGVyRE9NKSkgOiAnJyk7CiAgICAgIH07CgogICAgICB2YXIgUmljaFRleHQgPSBmdW5jdGlvbiBSaWNoVGV4dChpc0Vycm9yKSB7CiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBpZDogIlJpY2hUZXh0IiwKICAgICAgICAgIGNsYXNzTmFtZTogIiIuY29uY2F0KGlzRXJyb3IpLAogICAgICAgICAgX19zZWxmOiBfdGhpczQsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiA4NDEsCiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogNDIKICAgICAgICAgIH0KICAgICAgICB9LCBxdWVzdGlvblN0cnVjdHVyZS5tYXAoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICB2YXIgcmVzdWx0ID0gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAga2V5OiBpbmRleCwKICAgICAgICAgICAgX19zZWxmOiBfdGhpczQsCiAgICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgICBsaW5lTnVtYmVyOiA4NDQsCiAgICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAzNAogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBpZiAoaXRlbS50eXBlICE9PSAnY29tcHJlaGVuc2l2ZScpIHsKICAgICAgICAgICAgcmVzdWx0ID0gdG9waWNDb250ZW50KGl0ZW0sIGluZGV4KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgaWQ6ICJzaG93SW1nQm94IiwKICAgICAgICAgIF9fc2VsZjogX3RoaXM0LAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogODUyLAogICAgICAgICAgICBjb2x1bW5OdW1iZXI6IDEzCiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICB9OwoKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgX19zZWxmOiB0aGlzLAogICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgbGluZU51bWJlcjogODU3LAogICAgICAgICAgY29sdW1uTnVtYmVyOiAxNwogICAgICAgIH0KICAgICAgfSwgaGFzRXJyb3IgPyBSaWNoVGV4dCh0cnVlKSA6IFJpY2hUZXh0KGZhbHNlKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX19yZWFjdHN0YW5kaW5fX3JlZ2VuZXJhdGVCeUV2YWwiLAogICAgLy8gQHRzLWlnbm9yZQogICAgdmFsdWU6IGZ1bmN0aW9uIF9fcmVhY3RzdGFuZGluX19yZWdlbmVyYXRlQnlFdmFsKGtleSwgY29kZSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHRoaXNba2V5XSA9IGV2YWwoY29kZSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRWRpdEl0ZW07Cn0oQ29tcG9uZW50KTsKCmV4cG9ydCB7IEVkaXRJdGVtIGFzIGRlZmF1bHQgfTsKCmlmICh0eXBlb2YgRWRpdEl0ZW0gIT09ICd1bmRlZmluZWQnICYmIEVkaXRJdGVtICYmIEVkaXRJdGVtID09PSBPYmplY3QoRWRpdEl0ZW0pICYmIE9iamVjdC5pc0V4dGVuc2libGUoRWRpdEl0ZW0pKSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVkaXRJdGVtLCAnX19maWxlbWV0YScsIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICB2YWx1ZTogewogICAgICBuYW1lOiAiRWRpdEl0ZW0iLAogICAgICBmaWxlbmFtZTogInNyY1xcUXVlc3Rpb25FZGl0b3JcXGVkaXRvclxcaW5kZXgudHN4IgogICAgfQogIH0pOwp9CgppZiAodHlwZW9mIEVkaXRJdGVtICE9PSAndW5kZWZpbmVkJyAmJiBFZGl0SXRlbSAmJiBFZGl0SXRlbSA9PT0gT2JqZWN0KEVkaXRJdGVtKSAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKEVkaXRJdGVtKSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZGl0SXRlbSwgJ19fZmlsZW1ldGEnLCB7CiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgdmFsdWU6IHsKICAgICAgbmFtZTogIkVkaXRJdGVtIiwKICAgICAgZmlsZW5hbWU6ICJzcmNcXFF1ZXN0aW9uRWRpdG9yXFxlZGl0b3JcXGluZGV4LnRzeCIKICAgIH0KICB9KTsKfQoKOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgcmVhY3RIb3RMb2FkZXIgPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwuZGVmYXVsdCA6IHVuZGVmaW5lZDsKCiAgaWYgKCFyZWFjdEhvdExvYWRlcikgewogICAgcmV0dXJuOwogIH0KCiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoVGFiUGFuZSwgIlRhYlBhbmUiLCAiRjpcXHNsYXRlXFxlYXN0ZWR1Q29tcG9lbnRzXFxzcmNcXFF1ZXN0aW9uRWRpdG9yXFxlZGl0b3JcXGluZGV4LnRzeCIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKEVkaXRJdGVtLCAiRWRpdEl0ZW0iLCAiRjpcXHNsYXRlXFxlYXN0ZWR1Q29tcG9lbnRzXFxzcmNcXFF1ZXN0aW9uRWRpdG9yXFxlZGl0b3JcXGluZGV4LnRzeCIpOwp9KSgpOwoKOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgbGVhdmVNb2R1bGUgPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwubGVhdmVNb2R1bGUgOiB1bmRlZmluZWQ7CiAgbGVhdmVNb2R1bGUgJiYgbGVhdmVNb2R1bGUobW9kdWxlKTsKfSkoKTs="},{"version":3,"sources":["F:/slate/easteduCompoents/src/QuestionEditor/editor/index.tsx"],"names":["React","Component","RichText","ChoiceAnswer","JudgementAnswer","Tips","showMathJax","getQuestionHtml","getEmptyOption","questionTypeText","optionValue","getVideoUrl","debounce","_","TabPane","EditItem","hasError","props","changChild","console","error","changeValue","value","indexArr","ei","questionType","handleBatchOk","n","state","questionItem","questionStructure","isChangeQuestionList","type","videoUrl","JSON","parse","stringify","questionList","map","item","index","newQuestionItem","question","errList","length","open","message","errKey","filter","e","undefined","setState","activeKey","content","stem","push","alignment","fragments","mediaType","styles","indentation","questions","Object","keys","key","hasOwnProperty","element","handOkVal","chooseBox","newQuestionStructure","i","isChoose","readOnly","setAnswer","isFilled","log","changeAnswer","deleteOption","newQuestionStructures","isOnlyOption","indexOf","newQuestionStructure1","callback","postion","modalPosition","positionInsertFormula","modalPositionInsertFormula","changeItem","option","cloneDeep","children","text","calcelAnswers","el","eli","isAnswer","getAnswerStructure","setAnswers","contentItem","addAnswers","contents","autoFocus","splice","isAdd","String","Math","random","replace","requireText","deleteAnswers","result","character","includes","questionRenderCompleted","answer","orderSortVisible","visible","ActiveKey","left","top","color","sortFormat","isInBox","document","getElementById","addEventListener","preventDefault","stopPropagation","nextProps","time","search","renderDom","require","isFistRich","isChoice","copyQuestionMode","renderDOM","topicContent","title","cancelCopy","RichTextRender","isError"],"mappings":"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","sourcesContent":["\r\nimport React, { Component } from 'react';\r\nimport { Tabs, Button, Spin } from 'antd';\r\n\r\nimport RichText from './richtext';\r\nimport ChoiceAnswer from './choiceAnswer';\r\n\r\nimport JudgementAnswer from './components/JudgementAnswer';\r\n// import { Tips } from '../index';\r\nimport { Tips } from '../../MessageTips';\r\nimport {\r\n    changeJson,\r\n    showMathJax,\r\n    getQuestion,\r\n    getQuestionHtml,\r\n    getEmptyOption,\r\n    questionTypeText,\r\n    optionValue,\r\n    questionType,\r\n    getVideoUrl\r\n} from './client';\r\n\r\nimport debounce from 'lodash/debounce';\r\nimport './richtext.less';\r\nimport _ from 'lodash';\r\n\r\nconst { TabPane } = Tabs;\r\n// import LoadMath from './loadMath/index';\r\n\r\nexport interface EditItemProps {\r\n\r\n    value: any;\r\n    // changeValue: Function;\r\n    type: any;\r\n    handOkVal?: Function;\r\n    // onRef: Function;\r\n    questionStructure: any;\r\n    changeValue?: Function;\r\n    changeAnswer: Function;\r\n    cancelCopy?: Function;\r\n    search: any;\r\n    copyQuestionMode?: any;\r\n    renderDOM?: any\r\n}\r\n\r\ninterface EditItemState {\r\n\r\n    questionRenderCompleted: boolean\r\n    questionItem: any;\r\n    // initVal: any;\r\n    questionStructure: any;\r\n    type: any;\r\n    // value: any;\r\n    activeKey: string;\r\n    answer: any;\r\n    errList: any;\r\n    isChangeQuestionList: any;\r\n    hasError: boolean;\r\n    orderSortVisible: boolean;\r\n    modalPosition: any;\r\n    modalPositionInsertFormula: any;\r\n    color: string;\r\n    sortFormat: string;\r\n    isInBox: boolean; // 是否聚焦在输入框内\r\n    videoUrl: {\r\n        content: string;\r\n        questions: any\r\n    };\r\n    // questionObject: any;\r\n}\r\n\r\nimport ErrorBoundary from './errorBoundary';\r\nexport default class EditItem extends Component<EditItemProps, EditItemState> {\r\n\r\n    static getDerivedStateFromError() {\r\n        // Update state so the next render will show the fallback UI.\r\n        return { hasError: true };\r\n    }\r\n\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n\r\n\r\n        // let initVal = changeJson(props.value.question.stem);\r\n        let videoUrl = getVideoUrl(props.value.question);\r\n\r\n        this.state = {\r\n            questionRenderCompleted: false,\r\n            questionItem: JSON.parse(JSON.stringify(props.value)),\r\n            // initVal: initVal,\r\n            questionStructure: props.questionStructure,\r\n            type: props.value.question.questionType,\r\n            // value: initVal,\r\n            activeKey: '0',\r\n            answer: ['A'],\r\n            errList: [],\r\n            isChangeQuestionList: props.value.question.isChangeQuestionList || [],\r\n            hasError: false,\r\n            orderSortVisible: false,\r\n            modalPosition: {\r\n                visible: false,\r\n                ActiveKey: '0',\r\n                left: 'calc(50% - 200px)',\r\n                top: 'calc(50vh - 207px)',\r\n            },\r\n            modalPositionInsertFormula: {\r\n                visible: false,\r\n                ActiveKey: '0',\r\n                left: 'calc(50% - 500px)',\r\n                top: 'calc(50vh - 200px)',\r\n            },\r\n            color: 'black',\r\n            sortFormat: '1',\r\n            isInBox: false, // 是否聚焦在输入框内\r\n            videoUrl\r\n        };\r\n\r\n        this.changeValue = debounce(this.changeValue, 100);\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        showMathJax();\r\n\r\n        document.getElementById('RichText')?.addEventListener('dragstart', (e) => {\r\n\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            return false;\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n    componentWillReceiveProps(nextProps: any) {\r\n\r\n        let questionStructure = nextProps.questionStructure;\r\n\r\n        if (JSON.stringify(this.state.questionStructure) !== JSON.stringify(questionStructure)) {\r\n\r\n\r\n            // console.log('questionStructure====>', questionStructure);\r\n\r\n            // let transitionQuestionStructure = _.map(_.cloneDeep(questionStructure), (el: any) => {\r\n\r\n            //     el.content = [];\r\n            //     return el;\r\n            // });\r\n\r\n            this.setState({\r\n                questionStructure: [],\r\n            }, () => {\r\n\r\n                this.setState({\r\n\r\n                    questionStructure: questionStructure,\r\n                    type: nextProps.value.question.questionType,\r\n                }, () => {\r\n                    showMathJax(true);\r\n                });\r\n            })\r\n\r\n        }\r\n    }\r\n\r\n\r\n    componentDidCatch() {\r\n\r\n        const { hasError } = this.state;\r\n        Tips.open({\r\n            message: `输入错误，请重新输入！`,\r\n            type: 'fail',\r\n            time: 500\r\n        });\r\n        this.setState({ hasError: !hasError });\r\n        showMathJax(true);\r\n\r\n    }\r\n\r\n    // 父组件触犯\r\n    changChild = () => {\r\n\r\n        console.error('222');\r\n    }\r\n\r\n\r\n    changeValue = (value: any, indexArr: any, ei: any, questionType?: string) => {\r\n        // @ts-ignore\r\n        this.props.changeValue && this.props.changeValue(value, indexArr, ei, questionType);\r\n\r\n    }\r\n\r\n    handleBatchOk = (n: any) => {\r\n\r\n        const { questionItem, questionStructure, isChangeQuestionList, type, videoUrl } = this.state;\r\n\r\n        let changeValue = getQuestionHtml(JSON.parse(JSON.stringify(questionStructure)), type);\r\n\r\n        if (changeValue.questionList['questions']) {\r\n\r\n            changeValue.questionList['questions'] = changeValue.questionList['questions'].map((item: any, index: any) => {\r\n                return {\r\n                    ...questionItem['question']['questions'][index],\r\n                    ...item,\r\n                };\r\n            });\r\n        }\r\n\r\n        let newQuestionItem = {\r\n            ...questionItem,\r\n\r\n            question: {\r\n                ...questionItem['question'],\r\n                ...changeValue.questionList,\r\n                isChangeQuestionList: n === 1 ? isChangeQuestionList : [],\r\n            }\r\n        };\r\n\r\n        if (changeValue.errList.length > 0 && n !== 0) {\r\n            Tips.open({\r\n                message: `请完善内容`,\r\n                type: 'fail',\r\n            });\r\n\r\n            let errKey = changeValue.errList.map((item: any) => {\r\n                return item.index;\r\n            });\r\n\r\n            errKey = errKey.filter((e: any) => e !== undefined);\r\n\r\n            this.setState({\r\n                questionStructure: changeValue.question,\r\n                errList: errKey,\r\n                activeKey: `${errKey && errKey.length > 0 ? errKey[0] : this.state.activeKey}`\r\n            });\r\n\r\n        } else {\r\n\r\n            if (videoUrl.content) {\r\n                newQuestionItem.question.stem.push({\r\n                    alignment: \"Left\",\r\n                    fragments: [\r\n                        {\r\n                            content: videoUrl.content,\r\n                            mediaType: \"AUDIO\",\r\n                            styles: [],\r\n                        }\r\n                    ],\r\n                    indentation: 0,\r\n                    styles: []\r\n                })\r\n            };\r\n            if (videoUrl.questions && Object.keys(videoUrl.questions).length > 0) {\r\n                for (const key in videoUrl.questions) {\r\n                    if (videoUrl.questions.hasOwnProperty(key)) {\r\n                        const element = videoUrl.questions[key].content;\r\n                        if (element) {\r\n                            newQuestionItem.question.questions[key].stem.push({\r\n                                alignment: \"Left\",\r\n                                fragments: [\r\n                                    {\r\n                                        content: element,\r\n                                        mediaType: \"AUDIO\",\r\n                                        styles: [],\r\n                                    }\r\n                                ],\r\n                                indentation: 0,\r\n                                styles: []\r\n                            })\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            this.props.handOkVal && this.props.handOkVal(newQuestionItem, n);\r\n        }\r\n\r\n    }\r\n\r\n    chooseBox = (index: any) => {\r\n\r\n        const { questionStructure } = this.state;\r\n\r\n        let newQuestionStructure = questionStructure.map((item: any, i: number) => {\r\n            if (index !== i) {\r\n                item.isChoose = false;\r\n            } else {\r\n                item.isChoose = true;\r\n            }\r\n            item.readOnly = false;\r\n            return item;\r\n        });\r\n\r\n        this.setState({\r\n            questionStructure: newQuestionStructure\r\n        });\r\n\r\n    }\r\n\r\n\r\n    setAnswer = (e: any, ei: any) => {\r\n\r\n        const { questionStructure } = this.state;\r\n        let newQuestionStructure = JSON.parse(JSON.stringify(questionStructure)).map((questionItem: any) => {\r\n            if (questionItem.type === 'answer') {\r\n                questionItem.content = e;\r\n                questionItem.isFilled = true;\r\n            }\r\n\r\n            if (questionItem.type === 'comprehensive') {\r\n                questionItem.content[ei].map((item: any) => {\r\n                    if (item.type === 'answer') {\r\n                        item.content = e;\r\n                        item.isFilled = true;\r\n                    }\r\n                });\r\n            }\r\n            return questionItem;\r\n        });\r\n\r\n        console.log('newQuestionStructure==>', newQuestionStructure);\r\n\r\n        this.setState({\r\n            questionStructure: newQuestionStructure,\r\n\r\n        }, () => {\r\n\r\n            this.props.changeAnswer(newQuestionStructure);\r\n        });\r\n\r\n    }\r\n\r\n    // 删除选择题选项\r\n    deleteOption = (index: any, ei: any) => {\r\n        const { questionStructure, isChangeQuestionList } = this.state;\r\n        let newQuestionStructures: any;\r\n        let isOnlyOption = false;\r\n\r\n        newQuestionStructures = getEmptyOption(index, questionStructure, isOnlyOption, ei);\r\n\r\n        if (ei !== undefined) {\r\n            if (isChangeQuestionList.indexOf(ei) === -1) {\r\n                isChangeQuestionList.push(ei);\r\n            }\r\n        } else {\r\n            if (isChangeQuestionList.indexOf(-1) === -1) {\r\n                isChangeQuestionList.push(-1);\r\n            }\r\n        }\r\n\r\n\r\n        if (newQuestionStructures.isOnlyOption) {\r\n\r\n            Tips.open({\r\n                message: `至少包含两个选项`,\r\n                type: 'fail',\r\n            });\r\n\r\n        } else {\r\n            this.setState({\r\n                questionStructure: newQuestionStructures.newQuestionStructure\r\n            }, () => {\r\n                this.setState({\r\n                    questionStructure: newQuestionStructures.newQuestionStructure1,\r\n                    isChangeQuestionList\r\n                }, () => {\r\n\r\n                    showMathJax(true);\r\n\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    callback = (key: any) => {\r\n\r\n        const { questionItem, questionStructure, type } = this.state;\r\n\r\n        let changeValue = getQuestionHtml(JSON.parse(JSON.stringify(questionStructure)), type);\r\n\r\n        let errKey = changeValue.errList.map((item: any) => {\r\n            return item.index;\r\n        });\r\n\r\n        errKey = errKey.filter((e: any) => e !== undefined);\r\n\r\n        this.setState({\r\n            activeKey: key,\r\n            errList: errKey\r\n        }, () => {\r\n            showMathJax(true);\r\n        });\r\n    }\r\n\r\n    // 保存拖拽的位置\r\n    postion = (e: any) => {\r\n\r\n        this.setState({\r\n            modalPosition: e\r\n        });\r\n\r\n    }\r\n\r\n    positionInsertFormula = (e: any) => {\r\n        this.setState({\r\n            modalPositionInsertFormula: e\r\n        });\r\n\r\n    }\r\n\r\n    // 切换答案的类型\r\n    changeItem = (option: any) => {\r\n\r\n        const { questionStructure } = this.state;\r\n\r\n        let newQuestionStructure = _.map(questionStructure, (item: any) => {\r\n            if (item.type === 'answer') {\r\n                item.option = _.cloneDeep(option);\r\n                item.content = [{\r\n                    children: [{\r\n                        text: option[0],\r\n                        styles: [],\r\n                        type: 'Left'\r\n                    }]\r\n                }]\r\n            }\r\n            return item;\r\n        })\r\n\r\n        this.setState({\r\n            questionStructure: newQuestionStructure\r\n        }, () => {\r\n\r\n            this.props.changeAnswer(newQuestionStructure);\r\n        });\r\n\r\n        // console.log('questionStructure==>', questionStructure);\r\n\r\n    }\r\n\r\n    // 取消答案\r\n    // @ts-ignore\r\n    calcelAnswers = (index: any, i: any) => {\r\n        const { questionStructure, type } = this.state;\r\n\r\n        let newQuestionStructure = _.map(questionStructure, (item: any) => {\r\n            if (item.type === 'option') {\r\n                item.content = _.map(item.content, (el: any, eli: number) => {\r\n\r\n                    if (eli === i) {\r\n                        el = {\r\n                            ...el,\r\n                            isAnswer: false\r\n                        }\r\n                    }\r\n\r\n                    return el;\r\n                })\r\n            }\r\n\r\n            return item;\r\n        })\r\n\r\n        newQuestionStructure = this.getAnswerStructure(newQuestionStructure);\r\n\r\n        this.setState({\r\n            questionStructure: newQuestionStructure,\r\n        }, () => {\r\n            this.props.changeAnswer(newQuestionStructure);\r\n        });\r\n    }\r\n\r\n    // 设置答案\r\n    // @ts-ignore\r\n    setAnswers = (index: any, i: any) => {\r\n\r\n        const { questionStructure, type } = this.state;\r\n\r\n        console.log('newQuestionStructure==>', questionStructure);\r\n        let newQuestionStructure = _.map(questionStructure, (item: any) => {\r\n            // 修改报错的状态\r\n            item.isFilled = true;\r\n            if (item.type === 'option') {\r\n\r\n                if (type === 'SINGLE_CHOICE') {\r\n                    item.content = _.map(item.content, (el: any, eli: number) => {\r\n\r\n                        if (eli === i) {\r\n                            el = {\r\n                                ...el,\r\n                                isAnswer: true\r\n                            }\r\n                        } else {\r\n                            el = {\r\n                                ...el,\r\n                                isAnswer: false\r\n                            }\r\n                        }\r\n                        return el;\r\n                    })\r\n                } else {\r\n                    item.content = _.map(item.content, (el: any, eli: number) => {\r\n                        if (eli === i) {\r\n                            el = {\r\n                                ...el,\r\n                                isAnswer: true\r\n                            }\r\n                        }\r\n                        return el;\r\n                    })\r\n                }\r\n            }\r\n\r\n            return item;\r\n        })\r\n        newQuestionStructure = this.getAnswerStructure(questionStructure);\r\n\r\n        this.setState({\r\n            questionStructure: newQuestionStructure,\r\n        }, () => {\r\n            this.props.changeAnswer(newQuestionStructure);\r\n        });\r\n\r\n    }\r\n\r\n\r\n    getAnswerStructure = (newQuestionStructure: any) => {\r\n        let contentItem: any = [];\r\n\r\n        newQuestionStructure = _.map(newQuestionStructure, (item: any) => {\r\n            if (item.type === 'option') {\r\n                item.content = _.map(item.content, (el: any, eli: number) => {\r\n                    if (el.isAnswer) {\r\n                        contentItem.push(\r\n                            {\r\n                                children: [{\r\n                                    text: optionValue[eli]\r\n                                }],\r\n                                styles: [],\r\n                                type: 'Left'\r\n                            }\r\n                        );\r\n                    }\r\n                    return el;\r\n                })\r\n            }\r\n            return item;\r\n        });\r\n\r\n        newQuestionStructure = _.map(newQuestionStructure, (item: any) => {\r\n            if (item.type === 'answer') {\r\n                item.content = _.cloneDeep(contentItem);\r\n            }\r\n            return item;\r\n        })\r\n\r\n        return newQuestionStructure;\r\n    }\r\n\r\n    addAnswers = (index: any, i: any) => {\r\n        const { questionStructure } = this.state;\r\n\r\n        let newQuestionStructure = _.cloneDeep(questionStructure);\r\n\r\n        // console.log('questionStructure====>', _.cloneDeep(questionStructure));\r\n\r\n        let contents = newQuestionStructure[index]['content'];\r\n        newQuestionStructure[index]['content'] = _.map(contents, (item: any) => {\r\n            item = {\r\n                ...item,\r\n                autoFocus: false\r\n            }\r\n            return item;\r\n        })\r\n\r\n        newQuestionStructure[index]['content'].splice(i + 1, 0, {\r\n            children: [{ text: \"\", isAdd: true }],\r\n            isFilled: true,\r\n            autoFocus: true,\r\n            key: String(Math.random()).replace('\\.', ''),\r\n            requireText: \"内容不能为空\",\r\n            styles: [],\r\n            type: 'Left'\r\n        });\r\n\r\n        this.props.changeAnswer(_.cloneDeep(newQuestionStructure));\r\n\r\n    }\r\n\r\n    deleteAnswers = (index: any, i: any) => {\r\n\r\n        let { questionStructure } = this.state;\r\n\r\n        questionStructure[index]['content'].splice(i, 1);\r\n        let content = questionStructure[index]['content'].length;\r\n\r\n        // @ts-ignore\r\n        let option = optionValue.filter((el: any, index: number) => index < content);\r\n\r\n\r\n        // 删除的时候，对答案进行处理\r\n        questionStructure = _.map(questionStructure, (el: any) => {\r\n\r\n            if (el.type === 'answer') {\r\n\r\n                // console.log(value);\r\n                // 记录修改的题\r\n                // 判断是否为空的\r\n                el.content = el.content.map((item: any) => {\r\n                    item.children = item.children.filter((e: any) => {\r\n                        let text = '';\r\n                        let result = e.text ? e.text.replace(/(^\\s*)|(\\s*$)/g, '') : '';\r\n                        if (e.character) {\r\n                            result += e.character ? e.character.replace(/(^\\s*)|(\\s*$)/g, '') : '';\r\n                        }\r\n                        text += result;\r\n\r\n                        return option.includes(text);\r\n\r\n                    });\r\n                    item.option = _.cloneDeep(option);\r\n                    return item;\r\n                });\r\n            }\r\n            return el;\r\n        });\r\n\r\n        let newQuestionStructure = this.getAnswerStructure(questionStructure);\r\n\r\n        this.setState({\r\n            questionStructure: newQuestionStructure,\r\n        }, () => {\r\n\r\n            this.props.changeAnswer(_.cloneDeep(newQuestionStructure));\r\n        });\r\n\r\n    }\r\n\r\n\r\n    RichTextRender(item: any, index: any, ei: any) {\r\n\r\n        const { modalPosition, color, sortFormat, modalPositionInsertFormula, isInBox } = this.state;\r\n        const { search } = this.props;\r\n\r\n        let renderDom;\r\n\r\n        if (item.type !== 'option' && item.type !== 'answer') {\r\n            renderDom = <div>\r\n                <div className={!item.isFilled && item.require ? 'boxError' : 'RichTextInput'}>\r\n                    <RichText\r\n                        search={search}\r\n                        value={item.content}\r\n                        isFistRich={item.isFistRich}\r\n                        minHeight={63}\r\n                        id={`${index}${ei}`}\r\n                        changeValue={(e: any) => this.changeValue(e, [index], ei)}\r\n                        postion={(e: any) => this.postion(e)}\r\n                        positionInsertFormula={(e: any) => this.positionInsertFormula(e)}\r\n                        modalPosition={modalPosition}\r\n                        modalPositionInsertFormula={modalPositionInsertFormula}\r\n                        changeColor={(color: any) => this.setState({ color })}\r\n                        color={color}\r\n                        sortFormat={sortFormat}\r\n                        setFormat={(e: any) => this.setState({ sortFormat: e })}\r\n                        isInBox={isInBox}\r\n                    >\r\n                    </RichText>\r\n\r\n                </div>\r\n                {!item.isFilled && item.require ? <div className={'error'}>{item.requireText}</div> : ''}\r\n\r\n            </div>;\r\n        } else if (item.type !== 'answer') {\r\n\r\n            renderDom = <div className=\"optionContain\">\r\n                {\r\n                    item.content.map((contentItem: any, i: any) => {\r\n                        return <div\r\n                            key={contentItem.key || i}\r\n                            className={'optionBox1'}>\r\n                            <div\r\n                                className={'optionItem'}\r\n                            >\r\n                                {/* <div className={'item'}>\r\n                                    {optionValue[i]}\r\n                                </div> */}\r\n                                <div className={`${'richtext'}\r\n                                        optionContent\r\n                                        ${!contentItem.isFilled ? 'boxError' : 'RichTextInput'}\r\n                                        ${contentItem.isAnswer ? 'isAnswer' : ''}\r\n                                    `}\r\n                                    id={contentItem['autoFocus'] ? 'autoFocus' : ''}\r\n                                >\r\n                                    <div className=\"answerOptate\">\r\n                                        {\r\n                                            item.content.length > 2 ? <div className=\"cancelswer\" onClick={() => this.deleteAnswers(index, i)}>删除</div> : ''\r\n                                        }\r\n                                        {\r\n                                            !contentItem.isAnswer ?\r\n                                                <div className=\"answer\" onClick={() => this.setAnswers(index, i)}>设为答案</div>\r\n                                                : <div className=\"answer\" onClick={() => this.calcelAnswers(index, i)}>取消答案</div>\r\n                                        }\r\n                                        <div className=\"addswer\" onMouseUp={() => this.addAnswers(index, i)}>新增</div>\r\n                                    </div>\r\n                                    <RichText\r\n                                        search={search}\r\n                                        index={contentItem['Key']}\r\n                                        value={[contentItem]}\r\n                                        autoFocus={contentItem['autoFocus']}\r\n                                        isoption={true}\r\n                                        isOption={true}\r\n                                        id={`${index}${i}`}\r\n                                        isFilled={contentItem.isFilled}\r\n                                        changeValue={(e: any) => this.changeValue(e, [index, i], ei)}\r\n                                        postion={(e: any) => this.postion(e)}\r\n                                        positionInsertFormula={(e: any) => this.positionInsertFormula(e)}\r\n                                        modalPosition={modalPosition}\r\n                                        modalPositionInsertFormula={modalPositionInsertFormula}\r\n                                        changeColor={(color: any) => this.setState({ color })}\r\n                                        color={color}\r\n                                        sortFormat={sortFormat}\r\n                                        setFormat={(e: any) => this.setState({ sortFormat: e })}\r\n                                        isInBox={isInBox}\r\n                                    >\r\n                                    </RichText>\r\n                                </div>\r\n                            </div>\r\n                            {!contentItem.isFilled ? <div className={'error'}>{contentItem.requireText}</div> : ''}\r\n                        </div>;\r\n                    })\r\n                }\r\n            </div>\r\n        } else if (item.type === 'answer'\r\n            && (\r\n                item.questionType !== 'SINGLE_CHOICE' &&\r\n                item.questionType !== 'MULTIPLE_CHOICE' &&\r\n                item.questionType !== 'INDEFINITE_CHOICE'\r\n            )\r\n        ) {\r\n\r\n            renderDom = item.isChoice ? <div>\r\n                <ChoiceAnswer\r\n                    answer={item.content}\r\n                    option={item.option}\r\n                    questionType={item.questionType}\r\n                    setAnswer={(e: any) => this.setAnswer(e, ei)}\r\n                ></ChoiceAnswer>\r\n                {\r\n                    !item.isFilled && item.require ? <div className={'error'}>{item.requireText}</div> : ''\r\n                }\r\n            </div> : <div>\r\n                    <div className={!item.isFilled && item.require ? 'boxError' : 'RichTextInput'}>\r\n\r\n                        <RichText\r\n                            search={search}\r\n                            value={item.content}\r\n                            isFistRich={item.isFistRich}\r\n                            minHeight={63}\r\n                            id={`${index}${ei}`}\r\n                            changeValue={(e: any) => this.changeValue(e, [index], ei, 'answer')}\r\n                            postion={(e: any) => this.postion(e)}\r\n                            positionInsertFormula={(e: any) => this.positionInsertFormula(e)}\r\n                            modalPosition={modalPosition}\r\n                            modalPositionInsertFormula={modalPositionInsertFormula}\r\n                            changeColor={(color: any) => this.setState({ color })}\r\n                            color={color}\r\n                            sortFormat={sortFormat}\r\n                            setFormat={(e: any) => this.setState({ sortFormat: e })}\r\n                            isInBox={isInBox}\r\n                        >\r\n                        </RichText>\r\n\r\n                    </div>\r\n                    {!item.isFilled && item.require ? <div className={'error'}>{item.requireText}</div> : ''}\r\n                </div>;\r\n        } else if (item.type === 'answer') {\r\n\r\n            renderDom = item.isChoice ? <div>\r\n\r\n                {\r\n                    !item.isFilled && item.require ? <div className={'error'}>{item.requireText}</div> : ''\r\n                }\r\n            </div> : '';\r\n        }\r\n\r\n\r\n        return renderDom;\r\n    }\r\n\r\n    render() {\r\n\r\n        const { questionStructure, errList, activeKey, hasError, videoUrl } = this.state;\r\n        const { copyQuestionMode, renderDOM } = this.props;\r\n\r\n        let topicContent = (item: any, index: any, ei?: any) => <div key={index}>\r\n            {\r\n                item.type === 'answer' && (\r\n                    item.questionType === 'SINGLE_CHOICE' ||\r\n                    item.questionType === 'MULTIPLE_CHOICE' ||\r\n                    item.questionType === 'INDEFINITE_CHOICE'\r\n                ) ? '' : <div className={`${'title'}`}>\r\n                        {item.require ? <span className={'require'}>*</span> : ''}\r\n\r\n                        <span>{item.title}</span>\r\n                        {\r\n                            item.type === 'stem' && copyQuestionMode ?\r\n                                <span\r\n                                    className='copyQuestion'\r\n                                    onClick={() => this.props.cancelCopy}\r\n                                >\r\n                                    取消{copyQuestionMode === 1 ? '复制' : '引用'}\r\n                                </span>\r\n                                : ''\r\n                        }\r\n                        {item.type === 'option' ? <span className={'choiceTips'}>{questionTypeText[item['questionType']]}</span> : ''}\r\n                        {item.questionType === 'JUDGEMENT' && item.type === 'answer' ?\r\n                            <JudgementAnswer\r\n                                option={item.option}\r\n                                changeItem={(item: any) => this.changeItem(item)}\r\n                            ></JudgementAnswer> : ''}\r\n                    </div>\r\n            }\r\n\r\n            {this.RichTextRender(item, index, ei)}\r\n            {\r\n                item.type === 'stem' ?\r\n                    <div className=\"addQuestionItem\">\r\n\r\n                        <span className={'questionType'}>\r\n                            {renderDOM && renderDOM}\r\n                        </span>\r\n\r\n                    </div>\r\n                    : ''\r\n            }\r\n            {/* </Spin> */}\r\n        </div>;\r\n\r\n        let RichText = (isError: any) => <div id=\"RichText\" className={`${isError}`}>\r\n            {\r\n                questionStructure.map((item: any, index: any) => {\r\n                    let result = <div key={index}></div>;\r\n                    if (item.type !== 'comprehensive') {\r\n                        result = topicContent(item, index);\r\n                    }\r\n                    return result;\r\n                })\r\n            }\r\n\r\n            <div\r\n                id=\"showImgBox\"\r\n            ></div>\r\n        </div>;\r\n\r\n        return (<div>\r\n            {\r\n                hasError ? RichText(true) : RichText(false)\r\n            }\r\n        </div>\r\n        );\r\n    }\r\n}\r\n"]}]}