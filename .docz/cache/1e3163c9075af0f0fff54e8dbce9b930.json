{"remainingRequest":"F:\\slate\\easteduCompoents\\node_modules\\thread-loader\\dist\\cjs.js??ref--11-1!F:\\slate\\easteduCompoents\\node_modules\\docz-core\\node_modules\\babel-loader\\lib\\index.js??ref--11-2!F:\\slate\\easteduCompoents\\node_modules\\source-map-loader\\index.js!F:\\slate\\easteduCompoents\\src\\QuestionEditor\\editor\\components\\FormulaEditor.tsx","dependencies":[{"path":"F:\\slate\\easteduCompoents\\src\\QuestionEditor\\editor\\components\\FormulaEditor.tsx","mtime":1611717864166},{"path":"F:\\slate\\easteduCompoents\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1611297672593},{"path":"F:\\slate\\easteduCompoents\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1611297676370},{"path":"F:\\slate\\easteduCompoents\\node_modules\\docz-core\\node_modules\\babel-loader\\lib\\index.js","mtime":1611297672218},{"path":"F:\\slate\\easteduCompoents\\node_modules\\source-map-loader\\index.js","mtime":1599723087186}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJhbnRkL2VzL21vZGFsL3N0eWxlIjsKaW1wb3J0IF9Nb2RhbCBmcm9tICJhbnRkL2VzL21vZGFsIjsKaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkY6XFxzbGF0ZVxcZWFzdGVkdUNvbXBvZW50c1xcbm9kZV9tb2R1bGVzXFxiYWJlbC1wcmVzZXQtcmVhY3QtYXBwXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKCnZhciBfdGhpcyA9IHRoaXMsCiAgICBfanN4RmlsZU5hbWUgPSAiRjpcXHNsYXRlXFxlYXN0ZWR1Q29tcG9lbnRzXFxzcmNcXFF1ZXN0aW9uRWRpdG9yXFxlZGl0b3JcXGNvbXBvbmVudHNcXEZvcm11bGFFZGl0b3IudHN4IjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGVudGVyTW9kdWxlID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmVudGVyTW9kdWxlIDogdW5kZWZpbmVkOwogIGVudGVyTW9kdWxlICYmIGVudGVyTW9kdWxlKG1vZHVsZSk7Cn0pKCk7Cgp2YXIgX19zaWduYXR1cmVfXyA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbFsiZGVmYXVsdCJdLnNpZ25hdHVyZSA6IGZ1bmN0aW9uIChhKSB7CiAgcmV0dXJuIGE7Cn07CgovLyBAdHMtbm9jaGVjawppbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnOwppbXBvcnQgJy4uL2ljb25Db21wZW50cy9pY29uQ29tcGVudHMubGVzcyc7IC8vIGltcG9ydCB7IFRpcHMgfSBmcm9tICcuLi8uLi8uLi9jb21wb25lbnRzL2luZGV4JzsKCmltcG9ydCB7IFRpcHMgfSBmcm9tICcuLi8uLi8uLi9NZXNzYWdlVGlwcy9pbmRleCc7CmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7Cgp2YXIgRm9ybXVsYUVkaXRvciA9IGZ1bmN0aW9uIEZvcm11bGFFZGl0b3IocHJvcHMpIHsKICB2YXIgZWRpdG9yUmVmID0gdXNlUmVmKCk7CgogIHZhciBfdXNlU3RhdGUgPSB1c2VTdGF0ZShudWxsKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIGVkaXRvciA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldEVkaXRvciA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBfdXNlU3RhdGUzID0gdXNlU3RhdGUocHJvcHMuZm9ybXVsYS5yZXBsYWNlKCcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTgvTWF0aC9NYXRoTUwiJywgJycpKSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBmb3JtdWxhID0gX3VzZVN0YXRlNFswXSwKICAgICAgc2V0Rm9ybXVsYSA9IF91c2VTdGF0ZTRbMV07CgogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBpZiAoIWVkaXRvcikgewogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zb2xlLmxvZygnZWRpdG9yUmVmLmN1cnJlbnQ9PT4nLCBlZGl0b3JSZWYuY3VycmVudCk7CiAgICAgICAgdmFyIGVkaXRvciA9ICQoZWRpdG9yUmVmLmN1cnJlbnQpLm1hdGhFZGl0b3IoewogICAgICAgICAgd2lkdGg6IDEwMDAsCiAgICAgICAgICBoZWlnaHQ6IDQ1MCwKICAgICAgICAgIGRlZkZvcm11bGE6IGZvcm11bGEKICAgICAgICB9KTsKICAgICAgICBzZXRFZGl0b3IoZWRpdG9yKTsKICAgICAgfSwgMCk7CiAgICB9IGVsc2UgaWYgKGVkaXRvci5tYXRoRWRpdG9yKSB7CiAgICAgIGVkaXRvci5tYXRoRWRpdG9yKCdzZXRNYXRoTUwnLCBwcm9wcy5mb3JtdWxhKTsKICAgIH0KCiAgICByZXR1cm4gZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgdmFyIGJvZHlEaXZzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdib2R5ID4gZGl2JykpOwogICAgICB2YXIgYm9keVNwYW5zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdib2R5ID4gc3BhbicpKTsKICAgICAgYm9keURpdnMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICBpZiAoZWwuZ2V0QXR0cmlidXRlICYmIGVsLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSAmJiAoZWwuZ2V0QXR0cmlidXRlKCdjbGFzcycpLmluZGV4T2YoJ3VpLScpICE9PSAtMSB8fCBlbC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykuaW5kZXhPZignc3AtJykgIT09IC0xKSkgewogICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgYm9keVNwYW5zLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgaWYgKGVsLmdldEF0dHJpYnV0ZSAmJiBlbC5nZXRBdHRyaWJ1dGUoJ2lkJykgJiYgZWwuZ2V0QXR0cmlidXRlKCdpZCcpLmluZGV4T2YoJ3NwYW5OJykgIT09IC0xKSB7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICB9LCBbcHJvcHMuZm9ybXVsYV0pOwoKICBmdW5jdGlvbiBfb25PaygpIHsKICAgIHZhciBmb3JtdWxhUmVzdWx0ID0gZWRpdG9yID8gZWRpdG9yLm1hdGhFZGl0b3IoJ2dldE1hdGhNTCcsICdVTklDT0RFJywgJ3RydWUnKSA6IG51bGw7CiAgICB2YXIgZm9ybXVsYURPTSA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZm9ybXVsYVJlc3VsdCwgJ3RleHQvaHRtbCcpOwogICAgdmFyIG1hdGhFbCA9IGZvcm11bGFET00uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21hdGgnKVswXTsKCiAgICBpZiAobWF0aEVsLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSAmJiAhbWF0aEVsLmNoaWxkcmVuWzBdLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICBUaXBzLm9wZW4oewogICAgICAgIG1lc3NhZ2U6ICflhoXlrrnkuI3og73kuLrnqbonLAogICAgICAgIHR5cGU6ICdmYWlsJwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHByb3BzLm9uU3VibWl0KGZvcm11bGFSZXN1bHQpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gX29uQ2FuY2VsKCkgewogICAgcHJvcHMub25TdWJtaXQobnVsbCk7CiAgfQoKICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoX01vZGFsLCB7CiAgICB2aXNpYmxlOiB0cnVlLAogICAgbWFza0Nsb3NhYmxlOiBmYWxzZSwKICAgIHdpZHRoOiAxMDAwLAogICAgYm9keVN0eWxlOiB7CiAgICAgIHdpZHRoOiAxMDAwLAogICAgICBoZWlnaHQ6IDQ1MCwKICAgICAgcGFkZGluZzogMCwKICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nCiAgICB9LAogICAgdGl0bGU6ICJcdTUxNkNcdTVGMEZcdTdGMTZcdThGOTFcdTU2NjgiLAogICAgb25PazogZnVuY3Rpb24gb25PaygpIHsKICAgICAgX29uT2soKTsKICAgIH0sCiAgICBvbkNhbmNlbDogZnVuY3Rpb24gb25DYW5jZWwoKSB7CiAgICAgIF9vbkNhbmNlbCgpOwogICAgfSwKICAgIF9fc2VsZjogX3RoaXMsCiAgICBfX3NvdXJjZTogewogICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICBsaW5lTnVtYmVyOiA3NCwKICAgICAgY29sdW1uTnVtYmVyOiA5CiAgICB9CiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgIGNsYXNzTmFtZTogJ2NvbnRlbnQtYm9keScsCiAgICBzdHlsZTogewogICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJwogICAgfSwKICAgIF9fc2VsZjogX3RoaXMsCiAgICBfX3NvdXJjZTogewogICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICBsaW5lTnVtYmVyOiA4MywKICAgICAgY29sdW1uTnVtYmVyOiAxMwogICAgfQogIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICByZWY6IGVkaXRvclJlZiwKICAgIF9fc2VsZjogX3RoaXMsCiAgICBfX3NvdXJjZTogewogICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICBsaW5lTnVtYmVyOiA4NCwKICAgICAgY29sdW1uTnVtYmVyOiAxNwogICAgfQogIH0pKSk7Cn07CgpfX3NpZ25hdHVyZV9fKEZvcm11bGFFZGl0b3IsICJ1c2VSZWZ7ZWRpdG9yUmVmfVxudXNlU3RhdGV7W2VkaXRvciwgc2V0RWRpdG9yXShudWxsKX1cbnVzZVN0YXRle1tmb3JtdWxhLCBzZXRGb3JtdWxhXShwcm9wcy5mb3JtdWxhLnJlcGxhY2UoJyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTgvTWF0aC9NYXRoTUxcIicsICcnKSl9XG51c2VFZmZlY3R7fSIpOwoKdmFyIF9kZWZhdWx0ID0gRm9ybXVsYUVkaXRvcjsKZXhwb3J0IGRlZmF1bHQgX2RlZmF1bHQ7CgppZiAodHlwZW9mIEZvcm11bGFFZGl0b3IgIT09ICd1bmRlZmluZWQnICYmIEZvcm11bGFFZGl0b3IgJiYgRm9ybXVsYUVkaXRvciA9PT0gT2JqZWN0KEZvcm11bGFFZGl0b3IpICYmIE9iamVjdC5pc0V4dGVuc2libGUoRm9ybXVsYUVkaXRvcikpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybXVsYUVkaXRvciwgJ19fZmlsZW1ldGEnLCB7CiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgdmFsdWU6IHsKICAgICAgbmFtZTogIkZvcm11bGFFZGl0b3IiLAogICAgICBmaWxlbmFtZTogInNyY1xcUXVlc3Rpb25FZGl0b3JcXGVkaXRvclxcY29tcG9uZW50c1xcRm9ybXVsYUVkaXRvci50c3giCiAgICB9CiAgfSk7Cn0KCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIHJlYWN0SG90TG9hZGVyID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmRlZmF1bHQgOiB1bmRlZmluZWQ7CgogIGlmICghcmVhY3RIb3RMb2FkZXIpIHsKICAgIHJldHVybjsKICB9CgogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKEZvcm11bGFFZGl0b3IsICJGb3JtdWxhRWRpdG9yIiwgIkY6XFxzbGF0ZVxcZWFzdGVkdUNvbXBvZW50c1xcc3JjXFxRdWVzdGlvbkVkaXRvclxcZWRpdG9yXFxjb21wb25lbnRzXFxGb3JtdWxhRWRpdG9yLnRzeCIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKF9kZWZhdWx0LCAiZGVmYXVsdCIsICJGOlxcc2xhdGVcXGVhc3RlZHVDb21wb2VudHNcXHNyY1xcUXVlc3Rpb25FZGl0b3JcXGVkaXRvclxcY29tcG9uZW50c1xcRm9ybXVsYUVkaXRvci50c3giKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmxlYXZlTW9kdWxlIDogdW5kZWZpbmVkOwogIGxlYXZlTW9kdWxlICYmIGxlYXZlTW9kdWxlKG1vZHVsZSk7Cn0pKCk7"},{"version":3,"sources":["F:/slate/easteduCompoents/src/QuestionEditor/editor/components/FormulaEditor.tsx"],"names":["React","useState","useEffect","useRef","Tips","$","FormulaEditor","props","editorRef","editor","setEditor","formula","replace","setFormula","setTimeout","console","log","current","mathEditor","width","height","defFormula","cleanup","bodyDivs","Array","from","document","querySelectorAll","bodySpans","forEach","el","getAttribute","indexOf","body","removeChild","onOk","formulaResult","formulaDOM","DOMParser","parseFromString","mathEl","getElementsByTagName","children","length","open","message","type","onSubmit","onCancel","padding","overflow","position"],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { Modal } from 'antd';\r\nimport '../iconCompents/iconCompents.less';\r\n// import { Tips } from '../../../components/index';\r\nimport { Tips } from '../../../MessageTips/index';\r\nimport $ from 'jquery';\r\n\r\nconst FormulaEditor = (props) => {\r\n\r\n    const editorRef = useRef();\r\n    const [editor, setEditor] = useState(null);\r\n    const [formula, setFormula] = useState(props.formula.replace(' xmlns=\"http://www.w3.org/1998/Math/MathML\"', ''));\r\n\r\n    useEffect(() => {\r\n        if (!editor) {\r\n            setTimeout(() => {\r\n                console.log('editorRef.current==>', editorRef.current);\r\n                const editor = $(editorRef.current).mathEditor({\r\n                    width: 1000,\r\n                    height: 450,\r\n                    defFormula: formula\r\n                });\r\n                setEditor(editor);\r\n            }, 0);\r\n        } else if (editor.mathEditor) {\r\n            editor.mathEditor('setMathML', props.formula);\r\n        }\r\n        return function cleanup() {\r\n            const bodyDivs = Array.from(document.querySelectorAll('body > div'));\r\n            const bodySpans = Array.from(document.querySelectorAll('body > span'));\r\n            bodyDivs.forEach((el) => {\r\n                if (\r\n                    el.getAttribute && el.getAttribute('class') && (\r\n                        el.getAttribute('class').indexOf('ui-') !== -1 ||\r\n                        el.getAttribute('class').indexOf('sp-') !== -1\r\n                    )\r\n                ) {\r\n                    document.body.removeChild(el);\r\n                }\r\n            });\r\n            bodySpans.forEach((el) => {\r\n                if (\r\n                    el.getAttribute &&\r\n                    el.getAttribute('id') &&\r\n                    el.getAttribute('id').indexOf('spanN') !== -1\r\n                ) {\r\n                    document.body.removeChild(el);\r\n                }\r\n            });\r\n        };\r\n    }, [props.formula]);\r\n\r\n    function onOk() {\r\n\r\n        let formulaResult = editor ? editor.mathEditor('getMathML', 'UNICODE', 'true') : null;\r\n        const formulaDOM = new DOMParser().parseFromString(formulaResult, 'text/html');\r\n        const mathEl = formulaDOM.getElementsByTagName('math')[0];\r\n        if (mathEl.children.length === 1 && !mathEl.children[0].children.length) {\r\n            Tips.open({\r\n                message: '内容不能为空',\r\n                type: 'fail'\r\n            });\r\n        } else {\r\n            props.onSubmit(formulaResult);\r\n        }\r\n    }\r\n\r\n    function onCancel() {\r\n        props.onSubmit(null);\r\n    }\r\n\r\n    return (\r\n        <Modal\r\n            visible={true}\r\n            maskClosable={false}\r\n            width={1000}\r\n            bodyStyle={{ width: 1000, height: 450, padding: 0, overflow: 'hidden' }}\r\n            title=\"公式编辑器\"\r\n            onOk={() => { onOk() }}\r\n            onCancel={() => { onCancel() }}\r\n        >\r\n            <div className={'content-body'} style={{ position: 'relative' }}>\r\n                <div ref={editorRef} />\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default FormulaEditor;\r\n"]}]}